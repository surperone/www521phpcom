<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="robots" content="all" />
<title>php又一个zip压缩和解压缩实现 | 我爱你PHP张存超技术博客</title> 
 
<meta name="description" content="之前写了一个zip压缩的类，不过觉得并不是特别的好，今天又找了一个比较好的，有四种实现，在线压缩到服务器，压缩后直接下载，在线解压缩，在线查看内部文件，这四种，已经可以基本满足我们的需要了，不..." />
<meta name="keywords" content="php, zip, 函数, 类, " />
	
<link href="http://www.521php.com/wp-content/themes/zeke/style.css" rel="stylesheet" type="text/css" />
<link href="http://www.521php.com/wp-content/themes/zeke/miaov_style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="http://www.521php.com/wp-content/themes/zeke/comments-ajax.js"></script>
<link rel='stylesheet' id='crayon-css'  href='http://www.521php.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=2.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-ado-css'  href='http://www.521php.com/wp-content/plugins/crayon-syntax-highlighter/themes/ado/ado.css?ver=2.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-courier-new-css'  href='http://www.521php.com/wp-content/plugins/crayon-syntax-highlighter/fonts/courier-new.css?ver=2.2.0' type='text/css' media='all' />
<script type='text/javascript' src='http://www.521php.com/wp-includes/js/jquery/jquery.js?ver=1.7.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.2.0","is_admin":"0","ajaxurl":"http:\/\/www.521php.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};;
var CrayonSyntaxStrings = {"copy":"\u4f7f\u7528 %s \u590d\u5236\uff0c\u4f7f\u7528 %s \u7c98\u8d34\u3002","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.521php.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=2.2.0'></script>
<script type='text/javascript' src='http://www.521php.com/wp-includes/js/comment-reply.js?ver=20090102'></script>
<link rel='prev' title='php即点即改实现' href='http://www.521php.com/archives/530/' />
<link rel='next' title='js实现地区的二、三级联动' href='http://www.521php.com/archives/537/' />
<link rel='canonical' href='http://www.521php.com/archives/532/' />
<link rel='shortlink' href='http://www.521php.com/?p=532' />
<link rel="Shortcut Icon" type="image/x-icon" href="http://www.521php.com/favicon.ico" /><!--[if lt IE 7]>
<script type="text/javascript" src="/wp-content/themes/MRjs/iepngfix_tilebg.js"></script>
<script type="text/javascript">
// <![CDATA[
if((window.navigator.appName.toUpperCase().indexOf("MICROSOFT")>=0)&&(document.execCommand))
try{
document.execCommand("BackgroundImageCache", false, true);
}
catch(e){}
// ]]>
</script>
<![endif]-->
</head>

<body>
<div id="wrap">
<!--头部-->
	<div id="header">
    	<div id="top">
        	<div class="mrlogo"><a href="http://www.521php.com/" title="  php又一个zip压缩和解压缩实现-php个人博客,php技术博客,php博客">  php又一个zip压缩和解压缩实现-php个人博客,php技术博客,php博客</a></div>
            <div class="search"><form method="get" target="_blank" id="searchform" action="http://www.521php.com/so.php">
<input type="hidden" name="url" value="521php.com" />
            <input class="field" name="s" id="s" type="text" value="百度谷歌一起搜！" onfocus="this.value=&#39;&#39;;" onblur="if(this.value==&#39;&#39;){this.value=&#39;百度谷歌一起搜！&#39;;}" />
            <input name="" type="submit" value="" class="so"id="go"  onmouseout="this.className=&#39;so&#39;" onmouseover="this.className=&#39;soHover&#39;" />
            </form></div>
        </div>
        <div id="nav">
        	<div class="menuL"><ul id="menu" class="menu"><li id="menu-item-480" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-480"><a title="返回首页" href="http://www.521php.com/"><span>首页</span></a></li>
<li id="menu-item-41" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-41"><a title="心情随笔" href="http://www.521php.com/archives/category/cclog/"><span>随笔</span></a></li>
<li id="menu-item-43" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-43"><a title="php技术" href="http://www.521php.com/archives/category/lovephp/"><span>我爱PHP</span></a></li>
<li id="menu-item-182" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-182"><a title="博采众长" href="http://www.521php.com/archives/category/team/"><span>博采众长</span></a></li>
<li id="menu-item-1749" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1749"><a href="http://www.521php.com/archives/category/linux/"><span>Linux</span></a></li>
<li id="menu-item-514" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-514"><a title="小功能" href="http://www.521php.com/archives/category/gongneng/"><span>小功能</span></a></li>
<li id="menu-item-479" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-479"><a title="联系我" href="http://www.521php.com/message/"><span>关于我</span></a></li>
<li id="menu-item-1139" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1139"><a title="相册集" href="/xiangce/"><span>相册</span></a></li>
<li id="menu-item-993" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-993"><a title="友情链接" href="http://www.521php.com/flink/"><span>兄弟链</span></a></li>
<li id="menu-item-1613" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1613"><a title="cclovepp" href="http://love.521php.com"><span>CClovePP</span></a></li>
<li id="menu-item-1540" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1540"><a href="http://www.521php.com/video/"><span>我爱直播</span></a></li>
<li id="menu-item-1239" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1239"><a title="我爱外链" href="http://www.521php.com/wailian/"><span>外链自助</span></a></li>
</ul><span class="bgic"><img src="/images/bgic.gif"></span></div>
            <div class="rss_ico"><a href="http://www.521php.com/feed/" target="_blank" rel="nofollow" title="RSS订阅">RSS订阅</a></div>
        </div>
    </div>
<!--头部End-->
<div class="share_more" id="share_more" style="DISPLAY: none; LEFT: 160px; POSITION: absolute; TOP: 442px;">
<p onMouseOver="share_more_element.style.display='block';" onmouseout="share_more_element.style.display='none';">
<A class=share>分享到...</A> 
<A class="qqt" href="javascript:doShare('qqt');">腾讯微博</A>
<A class="sinat" href="javascript:doShare('sinat');">新浪微博</A>
<A class="qqpeng" href="javascript:doShare('qqpeng');">QQ朋友</A>
<A class="renren" href="javascript:doShare('renren');">人人网</A>
<A class="douban" href="javascript:doShare('douban');">豆瓣</A></p></div>
<SCRIPT type=text/javascript>
var share_more_element = null;
var share_postid = -1;
var postArray = [];
function getPos(obj){
	var pos = [];
	pos[0] = obj.offsetLeft;//X
	pos[1] = obj.offsetTop;//Y
	while (obj = obj.offsetParent){
		pos[0] += obj.offsetLeft;
		pos[1] += obj.offsetTop;
	}
	return pos;
}
//显示隐藏层
function share_more(postid, obj){
	share_postid = postid;
	var objPos = getPos(obj);
	objPos[0]-=7;objPos[1]-=5;
	if(share_more_element == null)share_more_element=document.getElementById("share_more");
	share_more_element.style.left=objPos[0]+"px";
	share_more_element.style.top=objPos[1]+"px";
	share_more_element.style.display="block";
}
//添加收藏夹
function doShare(stype){
	stitle = postArray[share_postid][0];
	surl = postArray[share_postid][1];
	sdire = postArray[share_postid][2];
	sbanner = postArray[share_postid][3];
	
	blogtitle = '张存超技术博客';
	bloghome = 'http://www.521php.com';
	
	stitle = blogtitle + ' - ' + stitle;
	
	switch(stype){
		case "fav":
			if (document.all){
				window.external.addFavorite(surl,stitle);
			}
			else if (window.sidebar){
				window.sidebar.addPanel(stitle,surl, "");
			}
			else{
				alert("抱歉,您的浏览器不支持添加到收藏夹,换个浏览器试试?");
			}
			break;
		//腾讯微博
		case "qqt":
			u=encodeURIComponent(surl);
			t=encodeURIComponent('#博客#：' + stitle);
			b=encodeURIComponent(sbanner);
			su=encodeURIComponent(bloghome);
			window.open('http://v.t.qq.com/share/share.php?title='+t+'&url='+u+'&site='+su+'&pic='+b,'_blank');	
			break;
		//新浪微博
		case "sinat":
			u=encodeURIComponent(surl);
			t=encodeURIComponent('#博客#：' + stitle);
			b=encodeURIComponent(sbanner);
			su=encodeURIComponent(bloghome);
			window.open('http://v.t.sina.com.cn/share/share.php?title='+t+'&url='+u+'&site='+su+'&pic='+b,'_blank');	
			break;
		//QQ朋友
		case "qqpeng":
			u=encodeURIComponent(surl);
			t=encodeURIComponent(stitle);
			b=encodeURIComponent(sbanner);
			su=encodeURIComponent(bloghome);
			window.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?to=pengyou&title='+t+'&url='+u+'&site='+su+'&pic='+b,'_blank');	
			break;
		//谷歌
		case "googlereader":
			u=encodeURIComponent(surl);
			t=encodeURIComponent(stitle);
			su=encodeURIComponent(bloghome);
			st=encodeURIComponent(blogtitle);
			window.open('http://www.google.com/reader/link?url='+u+'&title='+t+'&snippet=&srcTitle='+st+'&srcUrl='+su,'_blank');
			break;
		//人人网
		case "renren":
			u=encodeURIComponent(surl);
			t=encodeURIComponent(stitle);
			window.open('http://share.renren.com/share/buttonshare.do?link='+u+'&title='+t+'source=&sourceUrl=','_blank');
			break;
		//豆瓣
		case "douban":
			u=encodeURIComponent(surl);
			t=encodeURIComponent(stitle);
			window.open('http://www.douban.com/recommend/?url='+u+'&title='+t,'_blank');
			break;
	}
}
</SCRIPT>

<SCRIPT>postArray[0]=[];postArray[0][0]="张存超技术博客";postArray[0][1]="http://www.521php.com";postArray[0][2]="张存超技术博客 - http://www.521php.com";postArray[0][3]="http://www.521php.com/logo.png";</SCRIPT><!--中间内容-->
    <div id="container">
    	<div id="content">
	<div class="content_text">
          <div class="content_t_top"><!--样式头部--></div>
           		<div class="content_t_main"><div style="margin-left: 20px;">
<!--淘宝内容页推广start-->
		<script type="text/javascript">
     document.write('<a href="http://www.buydazhe.com" title="买就打折网" target="_blank"><img src="http://www.buydazhe.com/them/img/banner1.png" width="640" height="73" /></a>');
</script>
<!--淘宝内容页推广end--></div></div>
<div class="content_t_bot"><!--样式尾部--></div>
</div>
        	<div class="content_text">
            	<div class="content_t_top"><!--样式头部--></div>
           		<div class="content_t_main">
               		<!--ContentTitle-->
                    					<div class="ContentTitle">
                    	<div class="Data">
                        	<div class="DataLeft"><p class="monthB">25</p><p class="dateA">09-2012</p> </div>
                        </div>
                        <div class="Title">
                        	<H3><a href="http://www.521php.com/archives/532/" rel="bookmark">php又一个zip压缩和解压缩实现</a></H3>
                            <ul>
                            	<li class="mrinc name">地狱中仰望天堂</li>
                                <li class="mrinc date">2012-09-25</li>
                                <li class="mrinc folder"><a href="http://www.521php.com/archives/category/team/" title="查看 博采众长 中的全部文章" rel="category tag">博采众长</a>,<a href="http://www.521php.com/archives/category/lovephp/" title="查看 我爱PHP 中的全部文章" rel="category tag">我爱PHP</a>,<a href="http://www.521php.com/archives/category/tj/" title="查看 推荐文章 中的全部文章" rel="category tag">推荐文章</a></li>
                                <LI class="mrinc browse"><a href="#">浏览:1221</a></LI>
                          		<LI class="mrinc like"><a href="http://www.521php.com/archives/532/#comments" title="《php又一个zip压缩和解压缩实现》上的评论">评论:2</a></LI>
                                <li class="mrinc admin"></li>
                            </ul>
                        </div>
                    </div><!--content_banner-->
                    <div class="content_banner">
                    	
                        <div class="text" id="a532"><p>之前写了一个zip压缩的类，不过觉得并不是特别的好，今天又找了一个比较好的，有四种实现，在线压缩到服务器，压缩后直接下载，在线解压缩，在线查看内部文件，这四种，已经可以基本满足我们的需要了，不过这个类我用到了extract($_POST);对php版本好像有些要求，大家可以改一下，直接传值接收值，不要通过这个函数降维。这样写是为了方便。<a title="zip压缩" href="http://yunpan.cn/lk/52zku2ebvu" target="_blank">可以在这里下载</a>好了上代码<span id="more-532"></span></p><!-- Crayon Syntax Highlighter v2.2.0 -->

		<div id="crayon-53d2e08099fc1" class="crayon-syntax crayon-theme-ado crayon-font-courier-new crayon-os-pc print-yes" data-settings=" minimize scroll-mouseover wrap" style=" max-width: 645px; margin-top: 12px; margin-bottom: 12px; float: left; clear: both; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title">php又一个zip压缩和解压缩实现</span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-mixed-highlight" title="含多种语言"></span><div class="crayon-button crayon-nums-button" title="切换显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
&lt;?php
class PHPZip
{
private $ctrl_dir = array();
private $datasec = array();
/**********************************************************
* 压缩部分
**********************************************************/
// ------------------------------------------------------ //
// #遍历指定文件夹
//
// $archive = new PHPZip();
// $filelist = $archive-&gt;visitFile(文件夹路径);
// print "当前文件夹的文件:&lt;p&gt;\r\n";
// foreach($filelist as $file)
// printf("%s&lt;br&gt;\r\n", $file);
// ------------------------------------------------------ //
var $fileList = array();
public function visitFile($path)
{
global $fileList;
$path = str_replace("\\", "/", $path);
$fdir = dir($path);

while(($file = $fdir-&gt;read()) !== false)
{
if($file == '.' || $file == '..'){ continue; }

$pathSub = preg_replace("*/{2,}*", "/", $path."/".$file); // 替换多个反斜杠
$fileList[] = is_dir($pathSub) ? $pathSub."/" : $pathSub;
if(is_dir($pathSub)){ $this-&gt;visitFile($pathSub); }
}
$fdir-&gt;close();
return $fileList;
}

private function unix2DosTime($unixtime = 0)
{
$timearray = ($unixtime == 0) ? getdate() : getdate($unixtime);

if($timearray['year'] &lt; 1980)
{
$timearray['year'] = 1980;
$timearray['mon'] = 1;
$timearray['mday'] = 1;
$timearray['hours'] = 0;
$timearray['minutes'] = 0;
$timearray['seconds'] = 0;
}

return ( ($timearray['year'] - 1980) &lt;&lt; 25)
| ($timearray['mon'] &lt;&lt; 21)
| ($timearray['mday'] &lt;&lt; 16)
| ($timearray['hours'] &lt;&lt; 11)
| ($timearray['minutes'] &lt;&lt; 5)
| ($timearray['seconds'] &gt;&gt; 1);
}

var $old_offset = 0;
private function addFile($data, $filename, $time = 0)
{
$filename = str_replace('\\', '/', $filename);

$dtime = dechex($this-&gt;unix2DosTime($time));
$hexdtime = '\x' . $dtime[6] . $dtime[7]
. '\x' . $dtime[4] . $dtime[5]
. '\x' . $dtime[2] . $dtime[3]
. '\x' . $dtime[0] . $dtime[1];
eval('$hexdtime = "' . $hexdtime . '";');

$fr = "\x50\x4b\x03\x04";
$fr .= "\x14\x00";
$fr .= "\x00\x00";
$fr .= "\x08\x00";
$fr .= $hexdtime;
$unc_len = strlen($data);
$crc = crc32($data);
$zdata = gzcompress($data);
$c_len = strlen($zdata);
$zdata = substr(substr($zdata, 0, strlen($zdata) - 4), 2);
$fr .= pack('V', $crc);
$fr .= pack('V', $c_len);
$fr .= pack('V', $unc_len);
$fr .= pack('v', strlen($filename));
$fr .= pack('v', 0);
$fr .= $filename;

$fr .= $zdata;

$fr .= pack('V', $crc);
$fr .= pack('V', $c_len);
$fr .= pack('V', $unc_len);

$this-&gt;datasec[] = $fr;
$new_offset = strlen(implode('', $this-&gt;datasec));

$cdrec = "\x50\x4b\x01\x02";
$cdrec .= "\x00\x00";
$cdrec .= "\x14\x00";
$cdrec .= "\x00\x00";
$cdrec .= "\x08\x00";
$cdrec .= $hexdtime;
$cdrec .= pack('V', $crc);
$cdrec .= pack('V', $c_len);
$cdrec .= pack('V', $unc_len);
$cdrec .= pack('v', strlen($filename) );
$cdrec .= pack('v', 0 );
$cdrec .= pack('v', 0 );
$cdrec .= pack('v', 0 );
$cdrec .= pack('v', 0 );
$cdrec .= pack('V', 32 );

$cdrec .= pack('V', $this-&gt;old_offset );
$this-&gt;old_offset = $new_offset;

$cdrec .= $filename;
$this-&gt;ctrl_dir[] = $cdrec;
}

var $eof_ctrl_dir = "\x50\x4b\x05\x06\x00\x00\x00\x00";
private function file()
{
$data = implode('', $this-&gt;datasec);
$ctrldir = implode('', $this-&gt;ctrl_dir);

return $data
. $ctrldir
. $this-&gt;eof_ctrl_dir
. pack('v', sizeof($this-&gt;ctrl_dir))
. pack('v', sizeof($this-&gt;ctrl_dir))
. pack('V', strlen($ctrldir))
. pack('V', strlen($data))
. "\x00\x00";
}

// ------------------------------------------------------ //
// #压缩到服务器
//
// $archive = new PHPZip();
// $archive-&gt;Zip("需压缩的文件所在目录", "ZIP压缩文件名");
// ------------------------------------------------------ //
public function Zip($dir, $saveName)
{
if(@!function_exists('gzcompress')){ return; }

ob_end_clean();
$filelist = $this-&gt;visitFile($dir);
if(count($filelist) == 0){ return; }

foreach($filelist as $file)
{
if(!file_exists($file) || !is_file($file)){ continue; }

$fd = fopen($file, "rb");
$content = @fread($fd, filesize($file));
fclose($fd);

// 1.删除$dir的字符(./folder/file.txt删除./folder/)
// 2.如果存在/就删除(/file.txt删除/)
$file = substr($file, strlen($dir));
if(substr($file, 0, 1) == "\\" || substr($file, 0, 1) == "/"){ $file = substr($file, 1); }

$this-&gt;addFile($content, $file);
}
$out = $this-&gt;file();

$fp = fopen($saveName, "wb");
fwrite($fp, $out, strlen($out));
fclose($fp);
}

// ------------------------------------------------------ //
// #压缩并直接下载
//
// $archive = new PHPZip();
// $archive-&gt;ZipAndDownload("需压缩的文件所在目录");
// ------------------------------------------------------ //
public function ZipAndDownload($dir)
{
if(@!function_exists('gzcompress')){ return; }

ob_end_clean();
$filelist = $this-&gt;visitFile($dir);
if(count($filelist) == 0){ return; }

foreach($filelist as $file)
{
if(!file_exists($file) || !is_file($file)){ continue; }

$fd = fopen($file, "rb");
$content = @fread($fd, filesize($file));
fclose($fd);

// 1.删除$dir的字符(./folder/file.txt删除./folder/)
// 2.如果存在/就删除(/file.txt删除/)
$file = substr($file, strlen($dir));
if(substr($file, 0, 1) == "\\" || substr($file, 0, 1) == "/"){ $file = substr($file, 1); }

$this-&gt;addFile($content, $file);
}
$out = $this-&gt;file();

@header('Content-Encoding: none');
@header('Content-Type: application/zip');
@header('Content-Disposition: attachment ; filename=Farticle'.date("YmdHis", time()).'.zip');
@header('Pragma: no-cache');
@header('Expires: 0');
print($out);
}

/**********************************************************
* 解压部分
**********************************************************/
// ------------------------------------------------------ //
// ReadCentralDir($zip, $zipfile)
// $zip是经过@fopen($zipfile, 'rb')打开的
// $zipfile是zip文件的路径
// ------------------------------------------------------ //
private function ReadCentralDir($zip, $zipfile)
{
$size = filesize($zipfile);
$max_size = ($size &lt; 277) ? $size : 277;

@fseek($zip, $size - $max_size);
$pos = ftell($zip);
$bytes = 0x00000000;

while($pos &lt; $size)
{
$byte = @fread($zip, 1);
$bytes = ($bytes &lt;&lt; 8) | Ord($byte);
$pos++;
if($bytes == 0x504b0506){ break; }
}

$data = unpack('vdisk/vdisk_start/vdisk_entries/ventries/Vsize/Voffset/vcomment_size', fread($zip, 18));

$centd['comment'] = ($data['comment_size'] != 0) ? fread($zip, $data['comment_size']) : ''; // 注释
$centd['entries'] = $data['entries'];
$centd['disk_entries'] = $data['disk_entries'];
$centd['offset'] = $data['offset'];
$centd['disk_start'] = $data['disk_start'];
$centd['size'] = $data['size'];
$centd['disk'] = $data['disk'];
return $centd;
}

private function ReadCentralFileHeaders($zip)
{
$binary_data = fread($zip, 46);
$header = unpack('vchkid/vid/vversion/vversion_extracted/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len/vcomment_len/vdisk/vinternal/Vexternal/Voffset', $binary_data);

$header['filename'] = ($header['filename_len'] != 0) ? fread($zip, $header['filename_len']) : '';
$header['extra'] = ($header['extra_len'] != 0) ? fread($zip, $header['extra_len']) : '';
$header['comment'] = ($header['comment_len'] != 0) ? fread($zip, $header['comment_len']) : '';
if($header['mdate'] &amp;&amp; $header['mtime'])
{
$hour = ($header['mtime'] &amp; 0xF800) &gt;&gt; 11;
$minute = ($header['mtime'] &amp; 0x07E0) &gt;&gt; 5;
$seconde = ($header['mtime'] &amp; 0x001F) * 2;
$year = (($header['mdate'] &amp; 0xFE00) &gt;&gt; 9) + 1980;
$month = ($header['mdate'] &amp; 0x01E0) &gt;&gt; 5;
$day = $header['mdate'] &amp; 0x001F;
$header['mtime'] = mktime($hour, $minute, $seconde, $month, $day, $year);
} else {
$header['mtime'] = time();
}
$header['stored_filename'] = $header['filename'];
$header['status'] = 'ok';
if(substr($header['filename'], -1) == '/'){ $header['external'] = 0x41FF0010; } // 判断是否文件夹
return $header;
}

private function ReadFileHeader($zip)
{
$binary_data = fread($zip, 30);
$data = unpack('vchk/vid/vversion/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len', $binary_data);

$header['filename'] = fread($zip, $data['filename_len']);
$header['extra'] = ($data['extra_len'] != 0) ? fread($zip, $data['extra_len']) : '';
$header['compression'] = $data['compression'];
$header['size'] = $data['size'];
$header['compressed_size'] = $data['compressed_size'];
$header['crc'] = $data['crc'];
$header['flag'] = $data['flag'];
$header['mdate'] = $data['mdate'];
$header['mtime'] = $data['mtime'];

if($header['mdate'] &amp;&amp; $header['mtime']){
$hour = ($header['mtime'] &amp; 0xF800) &gt;&gt; 11;
$minute = ($header['mtime'] &amp; 0x07E0) &gt;&gt; 5;
$seconde = ($header['mtime'] &amp; 0x001F) * 2;
$year = (($header['mdate'] &amp; 0xFE00) &gt;&gt; 9) + 1980;
$month = ($header['mdate'] &amp; 0x01E0) &gt;&gt; 5;
$day = $header['mdate'] &amp; 0x001F;
$header['mtime'] = mktime($hour, $minute, $seconde, $month, $day, $year);
}else{
$header['mtime'] = time();
}

$header['stored_filename'] = $header['filename'];
$header['status'] = "ok";
return $header;
}

private function ExtractFile($header, $to, $zip)
{
$header = $this-&gt;readfileheader($zip);

if(substr($to, -1) != "/"){ $to .= "/"; }
if(!@is_dir($to)){ @mkdir($to, 0777); }

$pth = explode("/", dirname($header['filename']));
for($i=0; isset($pth[$i]); $i++){
if(!$pth[$i]){ continue; }
$pthss .= $pth[$i]."/";
if(!is_dir($to.$pthss)){ @mkdir($to.$pthss, 0777); }
}

if(!($header['external'] == 0x41FF0010) &amp;&amp; !($header['external'] == 16))
{
if($header['compression'] == 0)
{
$fp = @fopen($to.$header['filename'], 'wb');
if(!$fp){ return(-1); }
$size = $header['compressed_size'];

while($size != 0)
{
$read_size = ($size &lt; 2048 ? $size : 2048);
$buffer = fread($zip, $read_size);
$binary_data = pack('a'.$read_size, $buffer);
@fwrite($fp, $binary_data, $read_size);
$size -= $read_size;
}
fclose($fp);
touch($to.$header['filename'], $header['mtime']);

}else{

$fp = @fopen($to.$header['filename'].'.gz', 'wb');
if(!$fp){ return(-1); }
$binary_data = pack('va1a1Va1a1', 0x8b1f, Chr($header['compression']), Chr(0x00), time(), Chr(0x00), Chr(3));

fwrite($fp, $binary_data, 10);
$size = $header['compressed_size'];

while($size != 0)
{
$read_size = ($size &lt; 1024 ? $size : 1024);
$buffer = fread($zip, $read_size);
$binary_data = pack('a'.$read_size, $buffer);
@fwrite($fp, $binary_data, $read_size);
$size -= $read_size;
}

$binary_data = pack('VV', $header['crc'], $header['size']);
fwrite($fp, $binary_data, 8);
fclose($fp);

$gzp = @gzopen($to.$header['filename'].'.gz', 'rb') or die("Cette archive est compress!");

if(!$gzp){ return(-2); }
$fp = @fopen($to.$header['filename'], 'wb');
if(!$fp){ return(-1); }
$size = $header['size'];

while($size != 0)
{
$read_size = ($size &lt; 2048 ? $size : 2048);
$buffer = gzread($gzp, $read_size);
$binary_data = pack('a'.$read_size, $buffer);
@fwrite($fp, $binary_data, $read_size);
$size -= $read_size;
}
fclose($fp); gzclose($gzp);

touch($to.$header['filename'], $header['mtime']);
@unlink($to.$header['filename'].'.gz');
}
}
return true;
}

// ------------------------------------------------------ //
// #解压文件
//
// $archive = new PHPZip();
// $zipfile = "ZIP压缩文件名";
// $savepath = "解压缩目录名";
// $zipfile = $unzipfile;
// $savepath = $unziptarget;
// $array = $archive-&gt;GetZipInnerFilesInfo($zipfile);
// $filecount = 0;
// $dircount = 0;
// $failfiles = array();
// set_time_limit(0); // 修改为不限制超时时间(默认为30秒)
//
// for($i=0; $i&lt;count($array); $i++) {
// if($array[$i][folder] == 0){
// if($archive-&gt;unZip($zipfile, $savepath, $i) &gt; 0){
// $filecount++;
// }else{
// $failfiles[] = $array[$i][filename];
// }
// }else{
// $dircount++;
// }
// }
// set_time_limit(30);
//printf("文件夹:%d&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;解压文件:%d&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;失败:%d&lt;br&gt;\r\n", $dircount, $filecount, count($failfiles));
//if(count($failfiles) &gt; 0){
// foreach($failfiles as $file){
// printf("&amp;middot;%s&lt;br&gt;\r\n", $file);
// }
//}
// ------------------------------------------------------ //
public function unZip($zipfile, $to, $index = Array(-1))
{
$ok = 0;
$zip = @fopen($zipfile, 'rb');
if(!$zip){ return(-1); }

$cdir = $this-&gt;ReadCentralDir($zip, $zipfile);
$pos_entry = $cdir['offset'];

if(!is_array($index)){ $index = array($index); }
for($i=0; $index[$i]; $i++)
{
if(intval($index[$i]) != $index[$i] || $index[$i] &gt; $cdir['entries'])
{
return(-1);
}
}

for($i=0; $i&lt;$cdir['entries']; $i++)
{
@fseek($zip, $pos_entry);
$header = $this-&gt;ReadCentralFileHeaders($zip);
$header['index'] = $i;
$pos_entry = ftell($zip);
@rewind($zip);
fseek($zip, $header['offset']);
if(in_array("-1", $index) || in_array($i, $index))
{
$stat[$header['filename']] = $this-&gt;ExtractFile($header, $to, $zip);
}
}

fclose($zip);
return $stat;
}

/**********************************************************
* 其它部分
**********************************************************/
// ------------------------------------------------------ //
// #获取被压缩文件的信息
//
// $archive = new PHPZip();
// $array = $archive-&gt;GetZipInnerFilesInfo(ZIP压缩文件名);
// for($i=0; $i&lt;count($array); $i++) {
// printf("&lt;b&gt;&amp;middot;%s&lt;/b&gt;&lt;br&gt;\r\n", $array[$i][filename]);
// foreach($array[$i] as $key =&gt; $value)
// printf("%s =&gt; %s&lt;br&gt;\r\n", $key, $value);
// print "\r\n&lt;p&gt;------------------------------------&lt;p&gt;\r\n\r\n";
// }
// ------------------------------------------------------ //
public function GetZipInnerFilesInfo($zipfile)
{
$zip = @fopen($zipfile, 'rb');
if(!$zip){ return(0); }
$centd = $this-&gt;ReadCentralDir($zip, $zipfile);

@rewind($zip);
@fseek($zip, $centd['offset']);
$ret = array();

for($i=0; $i&lt;$centd['entries']; $i++)
{
$header = $this-&gt;ReadCentralFileHeaders($zip);
$header['index'] = $i;
$info = array(
'filename' =&gt; $header['filename'], // 文件名
'stored_filename' =&gt; $header['stored_filename'], // 压缩后文件名
'size' =&gt; $header['size'], // 大小
'compressed_size' =&gt; $header['compressed_size'], // 压缩后大小
'crc' =&gt; strtoupper(dechex($header['crc'])), // CRC32
'mtime' =&gt; date("Y-m-d H:i:s",$header['mtime']), // 文件修改时间
'comment' =&gt; $header['comment'], // 注释
'folder' =&gt; ($header['external'] == 0x41FF0010 || $header['external'] == 16) ? 1 : 0, // 是否为文件夹
'index' =&gt; $header['index'], // 文件索引
'status' =&gt; $header['status'] // 状态
);
$ret[] = $info;
unset($header);
}
fclose($zip);
return $ret;
}

// ------------------------------------------------------ //
// #获取压缩文件的注释
//
// $archive = new PHPZip();
// echo $archive-&gt;GetZipComment(ZIP压缩文件名);
// ------------------------------------------------------ //
public function GetZipComment($zipfile)
{
$zip = @fopen($zipfile, 'rb');
if(!$zip){ return(0); }
$centd = $this-&gt;ReadCentralDir($zip, $zipfile);
fclose($zip);
return $centd[comment];
}
}
?&gt;

&lt;form method="post"&gt;
压缩到服务器:
&lt;br&gt;------------------&lt;br&gt;
压缩目录:　　　　　&lt;input name="zipdir" type="text" id="zipdir" /&gt;(例如./folder)&lt;br&gt;
另存为路径和文件名:&lt;input name="savename" type="text" id="savename" /&gt;(例如./folder/file.zip)(需要填写扩展名)&lt;br&gt;
&lt;input name="zip" type="submit" id="zip" value="压缩" /&gt;&lt;br&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;

压缩并下载
&lt;br&gt;------------------&lt;br&gt;
文件所在目录:&lt;input name="zipdowndir" type="text" id="zipdowndir" /&gt;(例如./folder)&lt;br&gt;
&lt;input name="zipdown" type="submit" id="zipdown" value="压缩并下载" /&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;

在线解压zip
&lt;br&gt;------------------&lt;br&gt;
文件:　&lt;input name="unzipfile" type="text" id="unzipfile" /&gt;(例如./folder/file.zip)&lt;br&gt;
解压到:&lt;input name="unziptarget" type="text" id="unziptarget" /&gt;(例如./folder)&lt;br&gt;
&lt;input name="unzip" type="submit" id="unzip" value="解压" /&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;

读取压缩文件内部文件信息和注释
&lt;br&gt;------------------&lt;br&gt;
文件:&lt;input name="readfile" type="text" id="readfile" /&gt;(例如./folder/file.zip)&lt;br&gt;
&lt;input name="readfileinfo" type="submit" id="readfileinfo" value="读取内部文件信息" /&gt;
&lt;input name="readcomment" type="submit" id="readcomment" value="读取注释" /&gt;
&lt;/form&gt;
&lt;?
echo "&lt;p&gt;&lt;p&gt;\r\n";
echo "&lt;br&gt;--------------------------&lt;br&gt;\r\n";
echo "显示信息:\r\n";
echo "&lt;br&gt;--------------------------&lt;br&gt;\r\n";
extract($_POST);
$archive = new PHPZip();
if(!empty($zip))
{
$archive-&gt;Zip($zipdir, $savename);
}
elseif(!empty($zipdown))
{
$archive-&gt;ZipAndDownload($zipdowndir);
}
elseif(!empty($unzip))
{
$zipfile = $unzipfile;
$savepath = $unziptarget;
$array = $archive-&gt;GetZipInnerFilesInfo($zipfile);
$filecount = 0;
$dircount = 0;
$failfiles = array();
set_time_limit(0); // 修改为不限制超时时间(默认为30秒)

for($i=0; $i&lt;count($array); $i++) {
if($array[$i][folder] == 0){
if($archive-&gt;unZip($zipfile, $savepath, $i) &gt; 0){
$filecount++;
}else{
$failfiles[] = $array[$i][filename];
}
}else{
$dircount++;
}
}

set_time_limit(30);

printf("文件夹:%d&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;解压文件:%d&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;失败:%d&lt;br&gt;\r\n", $dircount, $filecount, count($failfiles));
if(count($failfiles) &gt; 0){
foreach($failfiles as $file){
printf("&amp;middot;%s&lt;br&gt;\r\n", $file);
}
}
}
elseif(!empty($readfileinfo))
{
$array = $archive-&gt;GetZipInnerFilesInfo($readfile);
for($i=0; $i&lt;count($array); $i++) {
printf("&lt;b&gt;&amp;middot;%s&lt;/b&gt;&lt;br&gt;\r\n", $array[$i][filename]);
foreach($array[$i] as $key =&gt; $value)
printf("%s =&gt; %s&lt;br&gt;\r\n", $key, $value);
print "\r\n&lt;p&gt;------------------------------------&lt;p&gt;\r\n\r\n";
}
}
elseif(!empty($readcomment))
{
$comment = $archive-&gt;GetZipComment($readfile);
printf("%s&lt;br&gt;\r\n", $comment);
}
?&gt;</textarea></div>
			<div class="crayon-main" style=" max-width: 645px;">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-53d2e08099fc1-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-2">2</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-4">4</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-6">6</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-8">8</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-10">10</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-12">12</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-14">14</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-16">16</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-18">18</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-20">20</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-22">22</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-24">24</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-26">26</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-28">28</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-30">30</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-32">32</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-34">34</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-36">36</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-38">38</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-40">40</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-42">42</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-44">44</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-46">46</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-48">48</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-50">50</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-52">52</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-54">54</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-56">56</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-58">58</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-60">60</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-62">62</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-64">64</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-66">66</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-68">68</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-70">70</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-72">72</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-74">74</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-76">76</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-78">78</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-80">80</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-82">82</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-84">84</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-86">86</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-88">88</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-90">90</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-92">92</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-94">94</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-96">96</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-98">98</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-100">100</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-102">102</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-104">104</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-106">106</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-108">108</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-110">110</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-112">112</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-114">114</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-116">116</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-118">118</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-120">120</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-122">122</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-124">124</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-126">126</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-128">128</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-130">130</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-132">132</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-134">134</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-136">136</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-138">138</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-140">140</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-142">142</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-144">144</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-146">146</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-148">148</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-150">150</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-152">152</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-154">154</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-156">156</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-158">158</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-160">160</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-162">162</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-164">164</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-166">166</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-168">168</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-170">170</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-172">172</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-174">174</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-176">176</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-178">178</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-180">180</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-182">182</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-184">184</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-186">186</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-188">188</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-190">190</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-192">192</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-194">194</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-196">196</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-198">198</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-199">199</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-200">200</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-201">201</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-202">202</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-203">203</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-204">204</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-205">205</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-206">206</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-207">207</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-208">208</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-209">209</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-210">210</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-211">211</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-212">212</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-213">213</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-214">214</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-215">215</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-216">216</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-217">217</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-218">218</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-219">219</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-220">220</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-221">221</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-222">222</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-223">223</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-224">224</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-225">225</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-226">226</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-227">227</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-228">228</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-229">229</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-230">230</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-231">231</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-232">232</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-233">233</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-234">234</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-235">235</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-236">236</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-237">237</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-238">238</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-239">239</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-240">240</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-241">241</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-242">242</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-243">243</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-244">244</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-245">245</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-246">246</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-247">247</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-248">248</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-249">249</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-250">250</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-251">251</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-252">252</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-253">253</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-254">254</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-255">255</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-256">256</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-257">257</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-258">258</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-259">259</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-260">260</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-261">261</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-262">262</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-263">263</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-264">264</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-265">265</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-266">266</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-267">267</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-268">268</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-269">269</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-270">270</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-271">271</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-272">272</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-273">273</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-274">274</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-275">275</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-276">276</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-277">277</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-278">278</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-279">279</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-280">280</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-281">281</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-282">282</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-283">283</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-284">284</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-285">285</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-286">286</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-287">287</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-288">288</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-289">289</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-290">290</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-291">291</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-292">292</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-293">293</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-294">294</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-295">295</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-296">296</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-297">297</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-298">298</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-299">299</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-300">300</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-301">301</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-302">302</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-303">303</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-304">304</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-305">305</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-306">306</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-307">307</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-308">308</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-309">309</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-310">310</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-311">311</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-312">312</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-313">313</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-314">314</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-315">315</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-316">316</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-317">317</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-318">318</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-319">319</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-320">320</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-321">321</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-322">322</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-323">323</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-324">324</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-325">325</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-326">326</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-327">327</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-328">328</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-329">329</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-330">330</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-331">331</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-332">332</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-333">333</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-334">334</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-335">335</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-336">336</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-337">337</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-338">338</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-339">339</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-340">340</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-341">341</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-342">342</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-343">343</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-344">344</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-345">345</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-346">346</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-347">347</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-348">348</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-349">349</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-350">350</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-351">351</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-352">352</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-353">353</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-354">354</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-355">355</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-356">356</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-357">357</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-358">358</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-359">359</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-360">360</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-361">361</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-362">362</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-363">363</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-364">364</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-365">365</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-366">366</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-367">367</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-368">368</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-369">369</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-370">370</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-371">371</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-372">372</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-373">373</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-374">374</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-375">375</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-376">376</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-377">377</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-378">378</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-379">379</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-380">380</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-381">381</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-382">382</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-383">383</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-384">384</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-385">385</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-386">386</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-387">387</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-388">388</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-389">389</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-390">390</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-391">391</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-392">392</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-393">393</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-394">394</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-395">395</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-396">396</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-397">397</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-398">398</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-399">399</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-400">400</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-401">401</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-402">402</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-403">403</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-404">404</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-405">405</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-406">406</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-407">407</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-408">408</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-409">409</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-410">410</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-411">411</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-412">412</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-413">413</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-414">414</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-415">415</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-416">416</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-417">417</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-418">418</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-419">419</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-420">420</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-421">421</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-422">422</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-423">423</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-424">424</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-425">425</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-426">426</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-427">427</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-428">428</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-429">429</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-430">430</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-431">431</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-432">432</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-433">433</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-434">434</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-435">435</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-436">436</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-437">437</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-438">438</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-439">439</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-440">440</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-441">441</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-442">442</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-443">443</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-444">444</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-445">445</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-446">446</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-447">447</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-448">448</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-449">449</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-450">450</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-451">451</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-452">452</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-453">453</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-454">454</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-455">455</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-456">456</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-457">457</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-458">458</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-459">459</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-460">460</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-461">461</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-462">462</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-463">463</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-464">464</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-465">465</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-466">466</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-467">467</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-468">468</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-469">469</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-470">470</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-471">471</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-472">472</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-473">473</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-474">474</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-475">475</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-476">476</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-477">477</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-478">478</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-479">479</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-480">480</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-481">481</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-482">482</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-483">483</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-484">484</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-485">485</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-486">486</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-487">487</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-488">488</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-489">489</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-490">490</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-491">491</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-492">492</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-493">493</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-494">494</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-495">495</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-496">496</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-497">497</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-498">498</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-499">499</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-500">500</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-501">501</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-502">502</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-503">503</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-504">504</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-505">505</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-506">506</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-507">507</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-508">508</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-509">509</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-510">510</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-511">511</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-512">512</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-513">513</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-514">514</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-515">515</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-516">516</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-517">517</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-518">518</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-519">519</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-520">520</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-521">521</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-522">522</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-523">523</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-524">524</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-525">525</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-526">526</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-527">527</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-528">528</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-529">529</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-530">530</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-531">531</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-532">532</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-533">533</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-534">534</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-535">535</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-536">536</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-537">537</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-538">538</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-539">539</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-540">540</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-541">541</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-542">542</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-543">543</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-544">544</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-545">545</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-546">546</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-547">547</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-548">548</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-549">549</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-550">550</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-551">551</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-552">552</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-553">553</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-554">554</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-555">555</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-556">556</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-557">557</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-558">558</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-559">559</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-560">560</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-561">561</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-562">562</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-563">563</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-564">564</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-565">565</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-566">566</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-567">567</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-568">568</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-569">569</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-570">570</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-571">571</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-572">572</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-573">573</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-574">574</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-575">575</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-576">576</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-577">577</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-578">578</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-579">579</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-580">580</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-581">581</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-582">582</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-583">583</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-584">584</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-585">585</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-586">586</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-587">587</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-588">588</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-589">589</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-590">590</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-591">591</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-592">592</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-593">593</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-594">594</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-595">595</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-596">596</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-597">597</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-598">598</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-599">599</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-600">600</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-601">601</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-602">602</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-603">603</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-604">604</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-605">605</div><div class="crayon-num crayon-striped-num" data-line="crayon-53d2e08099fc1-606">606</div><div class="crayon-num" data-line="crayon-53d2e08099fc1-607">607</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-53d2e08099fc1-1"><span class="ta">&lt;?php</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-2"><span class="t">class</span><span class="h"> </span><span class="e">PHPZip</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-3"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-4"><span class="m">private</span><span class="h"> </span><span class="v">$ctrl_dir</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="t">array</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-5"><span class="m">private</span><span class="h"> </span><span class="v">$datasec</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="t">array</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-6"><span class="c">/**********************************************************</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-7"><span class="c">* 压缩部分</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-8"><span class="c">**********************************************************/</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-9"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-10"><span class="c">// #遍历指定文件夹</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-11"><span class="c">//</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-12"><span class="c">// $archive = new PHPZip();</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-13"><span class="c">// $filelist = $archive-&gt;visitFile(文件夹路径);</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-14"><span class="c">// print "当前文件夹的文件:&lt;p&gt;\r\n";</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-15"><span class="c">// foreach($filelist as $file)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-16"><span class="c">// printf("%s&lt;br&gt;\r\n", $file);</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-17"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-18"><span class="t">var</span><span class="h"> </span><span class="v">$fileList</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="t">array</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-19"><span class="m">public</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">visitFile</span><span class="sy">(</span><span class="v">$path</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-20"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-21"><span class="m">global</span><span class="h"> </span><span class="v">$fileList</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-22"><span class="v">$path</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">str_replace</span><span class="sy">(</span><span class="s">"\\"</span><span class="sy">,</span><span class="h"> </span><span class="s">"/"</span><span class="sy">,</span><span class="h"> </span><span class="v">$path</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-23"><span class="v">$fdir</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">dir</span><span class="sy">(</span><span class="v">$path</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-24">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-25"><span class="st">while</span><span class="sy">(</span><span class="sy">(</span><span class="v">$file</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$fdir</span><span class="o">-&gt;</span><span class="e">read</span><span class="sy">(</span><span class="sy">)</span><span class="sy">)</span><span class="h"> </span><span class="o">!==</span><span class="h"> </span><span class="t">false</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-26"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-27"><span class="st">if</span><span class="sy">(</span><span class="v">$file</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="s">'.'</span><span class="h"> </span><span class="o">||</span><span class="h"> </span><span class="v">$file</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="s">'..'</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="st">continue</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-28">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-29"><span class="v">$pathSub</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">preg_replace</span><span class="sy">(</span><span class="s">"*/{2,}*"</span><span class="sy">,</span><span class="h"> </span><span class="s">"/"</span><span class="sy">,</span><span class="h"> </span><span class="v">$path</span><span class="sy">.</span><span class="s">"/"</span><span class="sy">.</span><span class="v">$file</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="c">// 替换多个反斜杠</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-30"><span class="v">$fileList</span><span class="sy">[</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">is_dir</span><span class="sy">(</span><span class="v">$pathSub</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="v">$pathSub</span><span class="sy">.</span><span class="s">"/"</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="v">$pathSub</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-31"><span class="st">if</span><span class="sy">(</span><span class="e">is_dir</span><span class="sy">(</span><span class="v">$pathSub</span><span class="sy">)</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">visitFile</span><span class="sy">(</span><span class="v">$pathSub</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-32"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-33"><span class="v">$fdir</span><span class="o">-&gt;</span><span class="e">close</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-34"><span class="k ">return</span><span class="h"> </span><span class="v">$fileList</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-35"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-36">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-37"><span class="m">private</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">unix2DosTime</span><span class="sy">(</span><span class="v">$unixtime</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-38"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-39"><span class="v">$timearray</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$unixtime</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="e">getdate</span><span class="sy">(</span><span class="sy">)</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="e">getdate</span><span class="sy">(</span><span class="v">$unixtime</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-40">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-41"><span class="st">if</span><span class="sy">(</span><span class="v">$timearray</span><span class="sy">[</span><span class="s">'year'</span><span class="sy">]</span><span class="h"> </span><span class="o">&lt;</span><span class="h"> </span><span class="cn">1980</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-42"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-43"><span class="v">$timearray</span><span class="sy">[</span><span class="s">'year'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">1980</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-44"><span class="v">$timearray</span><span class="sy">[</span><span class="s">'mon'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">1</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-45"><span class="v">$timearray</span><span class="sy">[</span><span class="s">'mday'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">1</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-46"><span class="v">$timearray</span><span class="sy">[</span><span class="s">'hours'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-47"><span class="v">$timearray</span><span class="sy">[</span><span class="s">'minutes'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-48"><span class="v">$timearray</span><span class="sy">[</span><span class="s">'seconds'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-49"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-50">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-51"><span class="k ">return</span><span class="h"> </span><span class="sy">(</span><span class="h"> </span><span class="sy">(</span><span class="v">$timearray</span><span class="sy">[</span><span class="s">'year'</span><span class="sy">]</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="cn">1980</span><span class="sy">)</span><span class="h"> </span><span class="o">&lt;&lt;</span><span class="h"> </span><span class="cn">25</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-52"><span class="o">|</span><span class="h"> </span><span class="sy">(</span><span class="v">$timearray</span><span class="sy">[</span><span class="s">'mon'</span><span class="sy">]</span><span class="h"> </span><span class="o">&lt;&lt;</span><span class="h"> </span><span class="cn">21</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-53"><span class="o">|</span><span class="h"> </span><span class="sy">(</span><span class="v">$timearray</span><span class="sy">[</span><span class="s">'mday'</span><span class="sy">]</span><span class="h"> </span><span class="o">&lt;&lt;</span><span class="h"> </span><span class="cn">16</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-54"><span class="o">|</span><span class="h"> </span><span class="sy">(</span><span class="v">$timearray</span><span class="sy">[</span><span class="s">'hours'</span><span class="sy">]</span><span class="h"> </span><span class="o">&lt;&lt;</span><span class="h"> </span><span class="cn">11</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-55"><span class="o">|</span><span class="h"> </span><span class="sy">(</span><span class="v">$timearray</span><span class="sy">[</span><span class="s">'minutes'</span><span class="sy">]</span><span class="h"> </span><span class="o">&lt;&lt;</span><span class="h"> </span><span class="cn">5</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-56"><span class="o">|</span><span class="h"> </span><span class="sy">(</span><span class="v">$timearray</span><span class="sy">[</span><span class="s">'seconds'</span><span class="sy">]</span><span class="h"> </span><span class="o">&gt;&gt;</span><span class="h"> </span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-57"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-58">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-59"><span class="t">var</span><span class="h"> </span><span class="v">$old_offset</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-60"><span class="m">private</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">addFile</span><span class="sy">(</span><span class="v">$data</span><span class="sy">,</span><span class="h"> </span><span class="v">$filename</span><span class="sy">,</span><span class="h"> </span><span class="v">$time</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-61"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-62"><span class="v">$filename</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">str_replace</span><span class="sy">(</span><span class="s">'\\'</span><span class="sy">,</span><span class="h"> </span><span class="s">'/'</span><span class="sy">,</span><span class="h"> </span><span class="v">$filename</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-63">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-64"><span class="v">$dtime</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">dechex</span><span class="sy">(</span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">unix2DosTime</span><span class="sy">(</span><span class="v">$time</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-65"><span class="v">$hexdtime</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="s">'\x'</span><span class="h"> </span><span class="sy">.</span><span class="h"> </span><span class="v">$dtime</span><span class="sy">[</span><span class="cn">6</span><span class="sy">]</span><span class="h"> </span><span class="sy">.</span><span class="h"> </span><span class="v">$dtime</span><span class="sy">[</span><span class="cn">7</span><span class="sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-66"><span class="sy">.</span><span class="h"> </span><span class="s">'\x'</span><span class="h"> </span><span class="sy">.</span><span class="h"> </span><span class="v">$dtime</span><span class="sy">[</span><span class="cn">4</span><span class="sy">]</span><span class="h"> </span><span class="sy">.</span><span class="h"> </span><span class="v">$dtime</span><span class="sy">[</span><span class="cn">5</span><span class="sy">]</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-67"><span class="sy">.</span><span class="h"> </span><span class="s">'\x'</span><span class="h"> </span><span class="sy">.</span><span class="h"> </span><span class="v">$dtime</span><span class="sy">[</span><span class="cn">2</span><span class="sy">]</span><span class="h"> </span><span class="sy">.</span><span class="h"> </span><span class="v">$dtime</span><span class="sy">[</span><span class="cn">3</span><span class="sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-68"><span class="sy">.</span><span class="h"> </span><span class="s">'\x'</span><span class="h"> </span><span class="sy">.</span><span class="h"> </span><span class="v">$dtime</span><span class="sy">[</span><span class="cn">0</span><span class="sy">]</span><span class="h"> </span><span class="sy">.</span><span class="h"> </span><span class="v">$dtime</span><span class="sy">[</span><span class="cn">1</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-69"><span class="k ">eval</span><span class="sy">(</span><span class="s">'$hexdtime = "'</span><span class="h"> </span><span class="sy">.</span><span class="h"> </span><span class="v">$hexdtime</span><span class="h"> </span><span class="sy">.</span><span class="h"> </span><span class="s">'";'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-70">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-71"><span class="v">$fr</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="s">"\x50\x4b\x03\x04"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-72"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="s">"\x14\x00"</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-73"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="s">"\x00\x00"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-74"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="s">"\x08\x00"</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-75"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="v">$hexdtime</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-76"><span class="v">$unc_len</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="v">$data</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-77"><span class="v">$crc</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">crc32</span><span class="sy">(</span><span class="v">$data</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-78"><span class="v">$zdata</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">gzcompress</span><span class="sy">(</span><span class="v">$data</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-79"><span class="v">$c_len</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="v">$zdata</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-80"><span class="v">$zdata</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">substr</span><span class="sy">(</span><span class="e">substr</span><span class="sy">(</span><span class="v">$zdata</span><span class="sy">,</span><span class="h"> </span><span class="cn">0</span><span class="sy">,</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="v">$zdata</span><span class="sy">)</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="cn">4</span><span class="sy">)</span><span class="sy">,</span><span class="h"> </span><span class="cn">2</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-81"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="v">$crc</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-82"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="v">$c_len</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-83"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="v">$unc_len</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-84"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'v'</span><span class="sy">,</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="v">$filename</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-85"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'v'</span><span class="sy">,</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-86"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="v">$filename</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-87">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-88"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="v">$zdata</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-90"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="v">$crc</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-91"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="v">$c_len</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-92"><span class="v">$fr</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="v">$unc_len</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-93">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-94"><span class="v">$this</span><span class="o">-&gt;</span><span class="i">datasec</span><span class="sy">[</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$fr</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-95"><span class="v">$new_offset</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="e">implode</span><span class="sy">(</span><span class="s">''</span><span class="sy">,</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="i">datasec</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-96">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-97"><span class="v">$cdrec</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="s">"\x50\x4b\x01\x02"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-98"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="s">"\x00\x00"</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-99"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="s">"\x14\x00"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-100"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="s">"\x00\x00"</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-101"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="s">"\x08\x00"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-102"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="v">$hexdtime</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-103"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="v">$crc</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-104"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="v">$c_len</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-105"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="v">$unc_len</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-106"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'v'</span><span class="sy">,</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="v">$filename</span><span class="sy">)</span><span class="h"> </span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-107"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'v'</span><span class="sy">,</span><span class="h"> </span><span class="cn">0</span><span class="h"> </span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-108"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'v'</span><span class="sy">,</span><span class="h"> </span><span class="cn">0</span><span class="h"> </span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-109"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'v'</span><span class="sy">,</span><span class="h"> </span><span class="cn">0</span><span class="h"> </span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-110"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'v'</span><span class="sy">,</span><span class="h"> </span><span class="cn">0</span><span class="h"> </span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-111"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="cn">32</span><span class="h"> </span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-112">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-113"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="i">old_offset</span><span class="h"> </span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-114"><span class="v">$this</span><span class="o">-&gt;</span><span class="i">old_offset</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$new_offset</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-115">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-116"><span class="v">$cdrec</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="v">$filename</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-117"><span class="v">$this</span><span class="o">-&gt;</span><span class="i">ctrl_dir</span><span class="sy">[</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$cdrec</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-118"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-119">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-120"><span class="t">var</span><span class="h"> </span><span class="v">$eof_ctrl_dir</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="s">"\x50\x4b\x05\x06\x00\x00\x00\x00"</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-121"><span class="m">private</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">file</span><span class="sy">(</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-122"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-123"><span class="v">$data</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">implode</span><span class="sy">(</span><span class="s">''</span><span class="sy">,</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="i">datasec</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-124"><span class="v">$ctrldir</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">implode</span><span class="sy">(</span><span class="s">''</span><span class="sy">,</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="i">ctrl_dir</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-125">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-126"><span class="k ">return</span><span class="h"> </span><span class="v">$data</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-127"><span class="sy">.</span><span class="h"> </span><span class="v">$ctrldir</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-128"><span class="sy">.</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="i">eof_ctrl_dir</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-129"><span class="sy">.</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'v'</span><span class="sy">,</span><span class="h"> </span><span class="e">sizeof</span><span class="sy">(</span><span class="v">$this</span><span class="o">-&gt;</span><span class="i">ctrl_dir</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-130"><span class="sy">.</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'v'</span><span class="sy">,</span><span class="h"> </span><span class="e">sizeof</span><span class="sy">(</span><span class="v">$this</span><span class="o">-&gt;</span><span class="i">ctrl_dir</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-131"><span class="sy">.</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="v">$ctrldir</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-132"><span class="sy">.</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'V'</span><span class="sy">,</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="v">$data</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-133"><span class="sy">.</span><span class="h"> </span><span class="s">"\x00\x00"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-134"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-135">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-136"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-137"><span class="c">// #压缩到服务器</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-138"><span class="c">//</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-139"><span class="c">// $archive = new PHPZip();</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-140"><span class="c">// $archive-&gt;Zip("需压缩的文件所在目录", "ZIP压缩文件名");</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-141"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-142"><span class="m">public</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">Zip</span><span class="sy">(</span><span class="v">$dir</span><span class="sy">,</span><span class="h"> </span><span class="v">$saveName</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-143"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-144"><span class="st">if</span><span class="sy">(</span><span class="sy">@</span><span class="o">!</span><span class="e">function_exists</span><span class="sy">(</span><span class="s">'gzcompress'</span><span class="sy">)</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-145">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-146"><span class="e">ob_end_clean</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-147"><span class="v">$filelist</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">visitFile</span><span class="sy">(</span><span class="v">$dir</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-148"><span class="st">if</span><span class="sy">(</span><span class="e">count</span><span class="sy">(</span><span class="v">$filelist</span><span class="sy">)</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-149">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-150"><span class="st">foreach</span><span class="sy">(</span><span class="v">$filelist</span><span class="h"> </span><span class="st">as</span><span class="h"> </span><span class="v">$file</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-151"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-152"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="e">file_exists</span><span class="sy">(</span><span class="v">$file</span><span class="sy">)</span><span class="h"> </span><span class="o">||</span><span class="h"> </span><span class="o">!</span><span class="e">is_file</span><span class="sy">(</span><span class="v">$file</span><span class="sy">)</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="st">continue</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-153">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-154"><span class="v">$fd</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">fopen</span><span class="sy">(</span><span class="v">$file</span><span class="sy">,</span><span class="h"> </span><span class="s">"rb"</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-155"><span class="v">$content</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">@</span><span class="e">fread</span><span class="sy">(</span><span class="v">$fd</span><span class="sy">,</span><span class="h"> </span><span class="e">filesize</span><span class="sy">(</span><span class="v">$file</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-156"><span class="e">fclose</span><span class="sy">(</span><span class="v">$fd</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-157">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-158"><span class="c">// 1.删除$dir的字符(./folder/file.txt删除./folder/)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-159"><span class="c">// 2.如果存在/就删除(/file.txt删除/)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-160"><span class="v">$file</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">substr</span><span class="sy">(</span><span class="v">$file</span><span class="sy">,</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="v">$dir</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-161"><span class="st">if</span><span class="sy">(</span><span class="e">substr</span><span class="sy">(</span><span class="v">$file</span><span class="sy">,</span><span class="h"> </span><span class="cn">0</span><span class="sy">,</span><span class="h"> </span><span class="cn">1</span><span class="sy">)</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="s">"\\"</span><span class="h"> </span><span class="o">||</span><span class="h"> </span><span class="e">substr</span><span class="sy">(</span><span class="v">$file</span><span class="sy">,</span><span class="h"> </span><span class="cn">0</span><span class="sy">,</span><span class="h"> </span><span class="cn">1</span><span class="sy">)</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="s">"/"</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="v">$file</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">substr</span><span class="sy">(</span><span class="v">$file</span><span class="sy">,</span><span class="h"> </span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-162">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-163"><span class="v">$this</span><span class="o">-&gt;</span><span class="e">addFile</span><span class="sy">(</span><span class="v">$content</span><span class="sy">,</span><span class="h"> </span><span class="v">$file</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-164"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-165"><span class="v">$out</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">file</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-166">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-167"><span class="v">$fp</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">fopen</span><span class="sy">(</span><span class="v">$saveName</span><span class="sy">,</span><span class="h"> </span><span class="s">"wb"</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-168"><span class="e">fwrite</span><span class="sy">(</span><span class="v">$fp</span><span class="sy">,</span><span class="h"> </span><span class="v">$out</span><span class="sy">,</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="v">$out</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-169"><span class="e">fclose</span><span class="sy">(</span><span class="v">$fp</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-170"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-171">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-172"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-173"><span class="c">// #压缩并直接下载</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-174"><span class="c">//</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-175"><span class="c">// $archive = new PHPZip();</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-176"><span class="c">// $archive-&gt;ZipAndDownload("需压缩的文件所在目录");</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-177"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-178"><span class="m">public</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">ZipAndDownload</span><span class="sy">(</span><span class="v">$dir</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-179"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-180"><span class="st">if</span><span class="sy">(</span><span class="sy">@</span><span class="o">!</span><span class="e">function_exists</span><span class="sy">(</span><span class="s">'gzcompress'</span><span class="sy">)</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-181">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-182"><span class="e">ob_end_clean</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-183"><span class="v">$filelist</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">visitFile</span><span class="sy">(</span><span class="v">$dir</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-184"><span class="st">if</span><span class="sy">(</span><span class="e">count</span><span class="sy">(</span><span class="v">$filelist</span><span class="sy">)</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-185">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-186"><span class="st">foreach</span><span class="sy">(</span><span class="v">$filelist</span><span class="h"> </span><span class="st">as</span><span class="h"> </span><span class="v">$file</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-187"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-188"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="e">file_exists</span><span class="sy">(</span><span class="v">$file</span><span class="sy">)</span><span class="h"> </span><span class="o">||</span><span class="h"> </span><span class="o">!</span><span class="e">is_file</span><span class="sy">(</span><span class="v">$file</span><span class="sy">)</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="st">continue</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-189">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-190"><span class="v">$fd</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">fopen</span><span class="sy">(</span><span class="v">$file</span><span class="sy">,</span><span class="h"> </span><span class="s">"rb"</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-191"><span class="v">$content</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">@</span><span class="e">fread</span><span class="sy">(</span><span class="v">$fd</span><span class="sy">,</span><span class="h"> </span><span class="e">filesize</span><span class="sy">(</span><span class="v">$file</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-192"><span class="e">fclose</span><span class="sy">(</span><span class="v">$fd</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-193">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-194"><span class="c">// 1.删除$dir的字符(./folder/file.txt删除./folder/)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-195"><span class="c">// 2.如果存在/就删除(/file.txt删除/)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-196"><span class="v">$file</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">substr</span><span class="sy">(</span><span class="v">$file</span><span class="sy">,</span><span class="h"> </span><span class="e">strlen</span><span class="sy">(</span><span class="v">$dir</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-197"><span class="st">if</span><span class="sy">(</span><span class="e">substr</span><span class="sy">(</span><span class="v">$file</span><span class="sy">,</span><span class="h"> </span><span class="cn">0</span><span class="sy">,</span><span class="h"> </span><span class="cn">1</span><span class="sy">)</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="s">"\\"</span><span class="h"> </span><span class="o">||</span><span class="h"> </span><span class="e">substr</span><span class="sy">(</span><span class="v">$file</span><span class="sy">,</span><span class="h"> </span><span class="cn">0</span><span class="sy">,</span><span class="h"> </span><span class="cn">1</span><span class="sy">)</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="s">"/"</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="v">$file</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">substr</span><span class="sy">(</span><span class="v">$file</span><span class="sy">,</span><span class="h"> </span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-198">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-199"><span class="v">$this</span><span class="o">-&gt;</span><span class="e">addFile</span><span class="sy">(</span><span class="v">$content</span><span class="sy">,</span><span class="h"> </span><span class="v">$file</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-200"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-201"><span class="v">$out</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">file</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-202">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-203"><span class="sy">@</span><span class="e">header</span><span class="sy">(</span><span class="s">'Content-Encoding: none'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-204"><span class="sy">@</span><span class="e">header</span><span class="sy">(</span><span class="s">'Content-Type: application/zip'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-205"><span class="sy">@</span><span class="e">header</span><span class="sy">(</span><span class="s">'Content-Disposition: attachment ; filename=Farticle'</span><span class="sy">.</span><span class="e">date</span><span class="sy">(</span><span class="s">"YmdHis"</span><span class="sy">,</span><span class="h"> </span><span class="e">time</span><span class="sy">(</span><span class="sy">)</span><span class="sy">)</span><span class="sy">.</span><span class="s">'.zip'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-206"><span class="sy">@</span><span class="e">header</span><span class="sy">(</span><span class="s">'Pragma: no-cache'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-207"><span class="sy">@</span><span class="e">header</span><span class="sy">(</span><span class="s">'Expires: 0'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-208"><span class="k ">print</span><span class="sy">(</span><span class="v">$out</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-209"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-210">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-211"><span class="c">/**********************************************************</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-212"><span class="c">* 解压部分</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-213"><span class="c">**********************************************************/</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-214"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-215"><span class="c">// ReadCentralDir($zip, $zipfile)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-216"><span class="c">// $zip是经过@fopen($zipfile, 'rb')打开的</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-217"><span class="c">// $zipfile是zip文件的路径</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-218"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-219"><span class="m">private</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">ReadCentralDir</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$zipfile</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-220"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-221"><span class="v">$size</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">filesize</span><span class="sy">(</span><span class="v">$zipfile</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-222"><span class="v">$max_size</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$size</span><span class="h"> </span><span class="o">&lt;</span><span class="h"> </span><span class="cn">277</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="v">$size</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="cn">277</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-223">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-224"><span class="sy">@</span><span class="e">fseek</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$size</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="v">$max_size</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-225"><span class="v">$pos</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">ftell</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-226"><span class="v">$bytes</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0x00000000</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-227">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-228"><span class="st">while</span><span class="sy">(</span><span class="v">$pos</span><span class="h"> </span><span class="o">&lt;</span><span class="h"> </span><span class="v">$size</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-229"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-230"><span class="v">$byte</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">@</span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-231"><span class="v">$bytes</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$bytes</span><span class="h"> </span><span class="o">&lt;&lt;</span><span class="h"> </span><span class="cn">8</span><span class="sy">)</span><span class="h"> </span><span class="o">|</span><span class="h"> </span><span class="e">Ord</span><span class="sy">(</span><span class="v">$byte</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-232"><span class="v">$pos</span><span class="o">++</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-233"><span class="st">if</span><span class="sy">(</span><span class="v">$bytes</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">0x504b0506</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="st">break</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-234"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-235">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-236"><span class="v">$data</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">unpack</span><span class="sy">(</span><span class="s">'vdisk/vdisk_start/vdisk_entries/ventries/Vsize/Voffset/vcomment_size'</span><span class="sy">,</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="cn">18</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-237">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-238"><span class="v">$centd</span><span class="sy">[</span><span class="s">'comment'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$data</span><span class="sy">[</span><span class="s">'comment_size'</span><span class="sy">]</span><span class="h"> </span><span class="o">!=</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'comment_size'</span><span class="sy">]</span><span class="sy">)</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="s">''</span><span class="sy">;</span><span class="h"> </span><span class="c">// 注释</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-239"><span class="v">$centd</span><span class="sy">[</span><span class="s">'entries'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'entries'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-240"><span class="v">$centd</span><span class="sy">[</span><span class="s">'disk_entries'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'disk_entries'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-241"><span class="v">$centd</span><span class="sy">[</span><span class="s">'offset'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'offset'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-242"><span class="v">$centd</span><span class="sy">[</span><span class="s">'disk_start'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'disk_start'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-243"><span class="v">$centd</span><span class="sy">[</span><span class="s">'size'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'size'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-244"><span class="v">$centd</span><span class="sy">[</span><span class="s">'disk'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'disk'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-245"><span class="k ">return</span><span class="h"> </span><span class="v">$centd</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-246"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-247">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-248"><span class="m">private</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">ReadCentralFileHeaders</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-249"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-250"><span class="v">$binary_data</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="cn">46</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-251"><span class="v">$header</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">unpack</span><span class="sy">(</span><span class="s">'vchkid/vid/vversion/vversion_extracted/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len/vcomment_len/vdisk/vinternal/Vexternal/Voffset'</span><span class="sy">,</span><span class="h"> </span><span class="v">$binary_data</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-252">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-253"><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename_len'</span><span class="sy">]</span><span class="h"> </span><span class="o">!=</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename_len'</span><span class="sy">]</span><span class="sy">)</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="s">''</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-254"><span class="v">$header</span><span class="sy">[</span><span class="s">'extra'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'extra_len'</span><span class="sy">]</span><span class="h"> </span><span class="o">!=</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'extra_len'</span><span class="sy">]</span><span class="sy">)</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="s">''</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-255"><span class="v">$header</span><span class="sy">[</span><span class="s">'comment'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'comment_len'</span><span class="sy">]</span><span class="h"> </span><span class="o">!=</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'comment_len'</span><span class="sy">]</span><span class="sy">)</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="s">''</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-256"><span class="st">if</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mdate'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;&amp;</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-257"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-258"><span class="v">$hour</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0xF800</span><span class="sy">)</span><span class="h"> </span><span class="o">&gt;&gt;</span><span class="h"> </span><span class="cn">11</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-259"><span class="v">$minute</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0x07E0</span><span class="sy">)</span><span class="h"> </span><span class="o">&gt;&gt;</span><span class="h"> </span><span class="cn">5</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-260"><span class="v">$seconde</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0x001F</span><span class="sy">)</span><span class="h"> </span><span class="o">*</span><span class="h"> </span><span class="cn">2</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-261"><span class="v">$year</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mdate'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0xFE00</span><span class="sy">)</span><span class="h"> </span><span class="o">&gt;&gt;</span><span class="h"> </span><span class="cn">9</span><span class="sy">)</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="cn">1980</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-262"><span class="v">$month</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mdate'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0x01E0</span><span class="sy">)</span><span class="h"> </span><span class="o">&gt;&gt;</span><span class="h"> </span><span class="cn">5</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-263"><span class="v">$day</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'mdate'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0x001F</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-264"><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">mktime</span><span class="sy">(</span><span class="v">$hour</span><span class="sy">,</span><span class="h"> </span><span class="v">$minute</span><span class="sy">,</span><span class="h"> </span><span class="v">$seconde</span><span class="sy">,</span><span class="h"> </span><span class="v">$month</span><span class="sy">,</span><span class="h"> </span><span class="v">$day</span><span class="sy">,</span><span class="h"> </span><span class="v">$year</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-265"><span class="sy">}</span><span class="h"> </span><span class="st">else</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-266"><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">time</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-267"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-268"><span class="v">$header</span><span class="sy">[</span><span class="s">'stored_filename'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-269"><span class="v">$header</span><span class="sy">[</span><span class="s">'status'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="s">'ok'</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-270"><span class="st">if</span><span class="sy">(</span><span class="e">substr</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="o">-</span><span class="cn">1</span><span class="sy">)</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="s">'/'</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'external'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0x41FF0010</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span><span class="h"> </span><span class="c">// 判断是否文件夹</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-271"><span class="k ">return</span><span class="h"> </span><span class="v">$header</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-272"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-273">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-274"><span class="m">private</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">ReadFileHeader</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-275"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-276"><span class="v">$binary_data</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="cn">30</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-277"><span class="v">$data</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">unpack</span><span class="sy">(</span><span class="s">'vchk/vid/vversion/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len'</span><span class="sy">,</span><span class="h"> </span><span class="v">$binary_data</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-278">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-279"><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'filename_len'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-280"><span class="v">$header</span><span class="sy">[</span><span class="s">'extra'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$data</span><span class="sy">[</span><span class="s">'extra_len'</span><span class="sy">]</span><span class="h"> </span><span class="o">!=</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'extra_len'</span><span class="sy">]</span><span class="sy">)</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="s">''</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-281"><span class="v">$header</span><span class="sy">[</span><span class="s">'compression'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'compression'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-282"><span class="v">$header</span><span class="sy">[</span><span class="s">'size'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'size'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-283"><span class="v">$header</span><span class="sy">[</span><span class="s">'compressed_size'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'compressed_size'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-284"><span class="v">$header</span><span class="sy">[</span><span class="s">'crc'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'crc'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-285"><span class="v">$header</span><span class="sy">[</span><span class="s">'flag'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'flag'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-286"><span class="v">$header</span><span class="sy">[</span><span class="s">'mdate'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'mdate'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-287"><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$data</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-288">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-289"><span class="st">if</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mdate'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;&amp;</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-290"><span class="v">$hour</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0xF800</span><span class="sy">)</span><span class="h"> </span><span class="o">&gt;&gt;</span><span class="h"> </span><span class="cn">11</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-291"><span class="v">$minute</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0x07E0</span><span class="sy">)</span><span class="h"> </span><span class="o">&gt;&gt;</span><span class="h"> </span><span class="cn">5</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-292"><span class="v">$seconde</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0x001F</span><span class="sy">)</span><span class="h"> </span><span class="o">*</span><span class="h"> </span><span class="cn">2</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-293"><span class="v">$year</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mdate'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0xFE00</span><span class="sy">)</span><span class="h"> </span><span class="o">&gt;&gt;</span><span class="h"> </span><span class="cn">9</span><span class="sy">)</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="cn">1980</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-294"><span class="v">$month</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mdate'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0x01E0</span><span class="sy">)</span><span class="h"> </span><span class="o">&gt;&gt;</span><span class="h"> </span><span class="cn">5</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-295"><span class="v">$day</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'mdate'</span><span class="sy">]</span><span class="h"> </span><span class="o">&amp;</span><span class="h"> </span><span class="cn">0x001F</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-296"><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">mktime</span><span class="sy">(</span><span class="v">$hour</span><span class="sy">,</span><span class="h"> </span><span class="v">$minute</span><span class="sy">,</span><span class="h"> </span><span class="v">$seconde</span><span class="sy">,</span><span class="h"> </span><span class="v">$month</span><span class="sy">,</span><span class="h"> </span><span class="v">$day</span><span class="sy">,</span><span class="h"> </span><span class="v">$year</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-297"><span class="sy">}</span><span class="st">else</span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-298"><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">time</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-299"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-300">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-301"><span class="v">$header</span><span class="sy">[</span><span class="s">'stored_filename'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-302"><span class="v">$header</span><span class="sy">[</span><span class="s">'status'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="s">"ok"</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-303"><span class="k ">return</span><span class="h"> </span><span class="v">$header</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-304"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-305">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-306"><span class="m">private</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">ExtractFile</span><span class="sy">(</span><span class="v">$header</span><span class="sy">,</span><span class="h"> </span><span class="v">$to</span><span class="sy">,</span><span class="h"> </span><span class="v">$zip</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-307"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-308"><span class="v">$header</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">readfileheader</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-309">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-310"><span class="st">if</span><span class="sy">(</span><span class="e">substr</span><span class="sy">(</span><span class="v">$to</span><span class="sy">,</span><span class="h"> </span><span class="o">-</span><span class="cn">1</span><span class="sy">)</span><span class="h"> </span><span class="o">!=</span><span class="h"> </span><span class="s">"/"</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="v">$to</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="s">"/"</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-311"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="sy">@</span><span class="e">is_dir</span><span class="sy">(</span><span class="v">$to</span><span class="sy">)</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="sy">@</span><span class="e">mkdir</span><span class="sy">(</span><span class="v">$to</span><span class="sy">,</span><span class="h"> </span><span class="cn">0777</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-312">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-313"><span class="v">$pth</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">explode</span><span class="sy">(</span><span class="s">"/"</span><span class="sy">,</span><span class="h"> </span><span class="e">dirname</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-314"><span class="st">for</span><span class="sy">(</span><span class="v">$i</span><span class="o">=</span><span class="cn">0</span><span class="sy">;</span><span class="h"> </span><span class="k ">isset</span><span class="sy">(</span><span class="v">$pth</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="v">$i</span><span class="o">++</span><span class="sy">)</span><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-315"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="v">$pth</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="st">continue</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-316"><span class="v">$pthss</span><span class="h"> </span><span class="sy">.</span><span class="o">=</span><span class="h"> </span><span class="v">$pth</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="sy">.</span><span class="s">"/"</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-317"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="e">is_dir</span><span class="sy">(</span><span class="v">$to</span><span class="sy">.</span><span class="v">$pthss</span><span class="sy">)</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="sy">@</span><span class="e">mkdir</span><span class="sy">(</span><span class="v">$to</span><span class="sy">.</span><span class="v">$pthss</span><span class="sy">,</span><span class="h"> </span><span class="cn">0777</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-318"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-319">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-320"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'external'</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">0x41FF0010</span><span class="sy">)</span><span class="h"> </span><span class="o">&amp;&amp;</span><span class="h"> </span><span class="o">!</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'external'</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">16</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-321"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-322"><span class="st">if</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'compression'</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-323"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-324"><span class="v">$fp</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">@</span><span class="e">fopen</span><span class="sy">(</span><span class="v">$to</span><span class="sy">.</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="s">'wb'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-325"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="v">$fp</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">(</span><span class="o">-</span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-326"><span class="v">$size</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'compressed_size'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-327">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-328"><span class="st">while</span><span class="sy">(</span><span class="v">$size</span><span class="h"> </span><span class="o">!=</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-329"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-330"><span class="v">$read_size</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$size</span><span class="h"> </span><span class="o">&lt;</span><span class="h"> </span><span class="cn">2048</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="v">$size</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="cn">2048</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-331"><span class="v">$buffer</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$read_size</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-332"><span class="v">$binary_data</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'a'</span><span class="sy">.</span><span class="v">$read_size</span><span class="sy">,</span><span class="h"> </span><span class="v">$buffer</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-333"><span class="sy">@</span><span class="e">fwrite</span><span class="sy">(</span><span class="v">$fp</span><span class="sy">,</span><span class="h"> </span><span class="v">$binary_data</span><span class="sy">,</span><span class="h"> </span><span class="v">$read_size</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-334"><span class="v">$size</span><span class="h"> </span><span class="o">-</span><span class="o">=</span><span class="h"> </span><span class="v">$read_size</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-335"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-336"><span class="e">fclose</span><span class="sy">(</span><span class="v">$fp</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-337"><span class="e">touch</span><span class="sy">(</span><span class="v">$to</span><span class="sy">.</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-338">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-339"><span class="sy">}</span><span class="st">else</span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-340">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-341"><span class="v">$fp</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">@</span><span class="e">fopen</span><span class="sy">(</span><span class="v">$to</span><span class="sy">.</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">.</span><span class="s">'.gz'</span><span class="sy">,</span><span class="h"> </span><span class="s">'wb'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-342"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="v">$fp</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">(</span><span class="o">-</span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-343"><span class="v">$binary_data</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'va1a1Va1a1'</span><span class="sy">,</span><span class="h"> </span><span class="cn">0x8b1f</span><span class="sy">,</span><span class="h"> </span><span class="e">Chr</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'compression'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">,</span><span class="h"> </span><span class="e">Chr</span><span class="sy">(</span><span class="cn">0x00</span><span class="sy">)</span><span class="sy">,</span><span class="h"> </span><span class="e">time</span><span class="sy">(</span><span class="sy">)</span><span class="sy">,</span><span class="h"> </span><span class="e">Chr</span><span class="sy">(</span><span class="cn">0x00</span><span class="sy">)</span><span class="sy">,</span><span class="h"> </span><span class="e">Chr</span><span class="sy">(</span><span class="cn">3</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-344">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-345"><span class="e">fwrite</span><span class="sy">(</span><span class="v">$fp</span><span class="sy">,</span><span class="h"> </span><span class="v">$binary_data</span><span class="sy">,</span><span class="h"> </span><span class="cn">10</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-346"><span class="v">$size</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'compressed_size'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-347">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-348"><span class="st">while</span><span class="sy">(</span><span class="v">$size</span><span class="h"> </span><span class="o">!=</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-349"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-350"><span class="v">$read_size</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$size</span><span class="h"> </span><span class="o">&lt;</span><span class="h"> </span><span class="cn">1024</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="v">$size</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="cn">1024</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-351"><span class="v">$buffer</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">fread</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$read_size</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-352"><span class="v">$binary_data</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'a'</span><span class="sy">.</span><span class="v">$read_size</span><span class="sy">,</span><span class="h"> </span><span class="v">$buffer</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-353"><span class="sy">@</span><span class="e">fwrite</span><span class="sy">(</span><span class="v">$fp</span><span class="sy">,</span><span class="h"> </span><span class="v">$binary_data</span><span class="sy">,</span><span class="h"> </span><span class="v">$read_size</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-354"><span class="v">$size</span><span class="h"> </span><span class="o">-</span><span class="o">=</span><span class="h"> </span><span class="v">$read_size</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-355"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-356">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-357"><span class="v">$binary_data</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'VV'</span><span class="sy">,</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'crc'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'size'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-358"><span class="e">fwrite</span><span class="sy">(</span><span class="v">$fp</span><span class="sy">,</span><span class="h"> </span><span class="v">$binary_data</span><span class="sy">,</span><span class="h"> </span><span class="cn">8</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-359"><span class="e">fclose</span><span class="sy">(</span><span class="v">$fp</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-360">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-361"><span class="v">$gzp</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">@</span><span class="e">gzopen</span><span class="sy">(</span><span class="v">$to</span><span class="sy">.</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">.</span><span class="s">'.gz'</span><span class="sy">,</span><span class="h"> </span><span class="s">'rb'</span><span class="sy">)</span><span class="h"> </span><span class="st">or</span><span class="h"> </span><span class="k ">die</span><span class="sy">(</span><span class="s">"Cette archive est compress!"</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-362">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-363"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="v">$gzp</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">(</span><span class="o">-</span><span class="cn">2</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-364"><span class="v">$fp</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">@</span><span class="e">fopen</span><span class="sy">(</span><span class="v">$to</span><span class="sy">.</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="s">'wb'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-365"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="v">$fp</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">(</span><span class="o">-</span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-366"><span class="v">$size</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'size'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-367">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-368"><span class="st">while</span><span class="sy">(</span><span class="v">$size</span><span class="h"> </span><span class="o">!=</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-369"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-370"><span class="v">$read_size</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="v">$size</span><span class="h"> </span><span class="o">&lt;</span><span class="h"> </span><span class="cn">2048</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="v">$size</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="cn">2048</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-371"><span class="v">$buffer</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">gzread</span><span class="sy">(</span><span class="v">$gzp</span><span class="sy">,</span><span class="h"> </span><span class="v">$read_size</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-372"><span class="v">$binary_data</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">pack</span><span class="sy">(</span><span class="s">'a'</span><span class="sy">.</span><span class="v">$read_size</span><span class="sy">,</span><span class="h"> </span><span class="v">$buffer</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-373"><span class="sy">@</span><span class="e">fwrite</span><span class="sy">(</span><span class="v">$fp</span><span class="sy">,</span><span class="h"> </span><span class="v">$binary_data</span><span class="sy">,</span><span class="h"> </span><span class="v">$read_size</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-374"><span class="v">$size</span><span class="h"> </span><span class="o">-</span><span class="o">=</span><span class="h"> </span><span class="v">$read_size</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-375"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-376"><span class="e">fclose</span><span class="sy">(</span><span class="v">$fp</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="e">gzclose</span><span class="sy">(</span><span class="v">$gzp</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-377">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-378"><span class="e">touch</span><span class="sy">(</span><span class="v">$to</span><span class="sy">.</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-379"><span class="sy">@</span><span class="e">unlink</span><span class="sy">(</span><span class="v">$to</span><span class="sy">.</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">.</span><span class="s">'.gz'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-380"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-381"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-382"><span class="k ">return</span><span class="h"> </span><span class="t">true</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-383"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-384">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-385"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-386"><span class="c">// #解压文件</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-387"><span class="c">//</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-388"><span class="c">// $archive = new PHPZip();</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-389"><span class="c">// $zipfile = "ZIP压缩文件名";</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-390"><span class="c">// $savepath = "解压缩目录名";</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-391"><span class="c">// $zipfile = $unzipfile;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-392"><span class="c">// $savepath = $unziptarget;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-393"><span class="c">// $array = $archive-&gt;GetZipInnerFilesInfo($zipfile);</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-394"><span class="c">// $filecount = 0;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-395"><span class="c">// $dircount = 0;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-396"><span class="c">// $failfiles = array();</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-397"><span class="c">// set_time_limit(0); // 修改为不限制超时时间(默认为30秒)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-398"><span class="c">//</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-399"><span class="c">// for($i=0; $i&lt;count($array); $i++) {</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-400"><span class="c">// if($array[$i][folder] == 0){</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-401"><span class="c">// if($archive-&gt;unZip($zipfile, $savepath, $i) &gt; 0){</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-402"><span class="c">// $filecount++;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-403"><span class="c">// }else{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-404"><span class="c">// $failfiles[] = $array[$i][filename];</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-405"><span class="c">// }</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-406"><span class="c">// }else{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-407"><span class="c">// $dircount++;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-408"><span class="c">// }</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-409"><span class="c">// }</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-410"><span class="c">// set_time_limit(30);</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-411"><span class="c">//printf("文件夹:%d&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;解压文件:%d&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;失败:%d&lt;br&gt;\r\n", $dircount, $filecount, count($failfiles));</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-412"><span class="c">//if(count($failfiles) &gt; 0){</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-413"><span class="c">// foreach($failfiles as $file){</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-414"><span class="c">// printf("&amp;middot;%s&lt;br&gt;\r\n", $file);</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-415"><span class="c">// }</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-416"><span class="c">//}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-417"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-418"><span class="m">public</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">unZip</span><span class="sy">(</span><span class="v">$zipfile</span><span class="sy">,</span><span class="h"> </span><span class="v">$to</span><span class="sy">,</span><span class="h"> </span><span class="v">$index</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="t">Array</span><span class="sy">(</span><span class="o">-</span><span class="cn">1</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-419"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-420"><span class="v">$ok</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-421"><span class="v">$zip</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">@</span><span class="e">fopen</span><span class="sy">(</span><span class="v">$zipfile</span><span class="sy">,</span><span class="h"> </span><span class="s">'rb'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-422"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">(</span><span class="o">-</span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-423">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-424"><span class="v">$cdir</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">ReadCentralDir</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$zipfile</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-425"><span class="v">$pos_entry</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$cdir</span><span class="sy">[</span><span class="s">'offset'</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-426">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-427"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="e">is_array</span><span class="sy">(</span><span class="v">$index</span><span class="sy">)</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="v">$index</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="t">array</span><span class="sy">(</span><span class="v">$index</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-428"><span class="st">for</span><span class="sy">(</span><span class="v">$i</span><span class="o">=</span><span class="cn">0</span><span class="sy">;</span><span class="h"> </span><span class="v">$index</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="sy">;</span><span class="h"> </span><span class="v">$i</span><span class="o">++</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-429"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-430"><span class="st">if</span><span class="sy">(</span><span class="e">intval</span><span class="sy">(</span><span class="v">$index</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="sy">)</span><span class="h"> </span><span class="o">!=</span><span class="h"> </span><span class="v">$index</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="h"> </span><span class="o">||</span><span class="h"> </span><span class="v">$index</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="h"> </span><span class="o">&gt;</span><span class="h"> </span><span class="v">$cdir</span><span class="sy">[</span><span class="s">'entries'</span><span class="sy">]</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-431"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-432"><span class="k ">return</span><span class="sy">(</span><span class="o">-</span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-433"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-434"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-435">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-436"><span class="st">for</span><span class="sy">(</span><span class="v">$i</span><span class="o">=</span><span class="cn">0</span><span class="sy">;</span><span class="h"> </span><span class="v">$i</span><span class="o">&lt;</span><span class="v">$cdir</span><span class="sy">[</span><span class="s">'entries'</span><span class="sy">]</span><span class="sy">;</span><span class="h"> </span><span class="v">$i</span><span class="o">++</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-437"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-438"><span class="sy">@</span><span class="e">fseek</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$pos_entry</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-439"><span class="v">$header</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">ReadCentralFileHeaders</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-440"><span class="v">$header</span><span class="sy">[</span><span class="s">'index'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$i</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-441"><span class="v">$pos_entry</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">ftell</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-442"><span class="sy">@</span><span class="e">rewind</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-443"><span class="e">fseek</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'offset'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-444"><span class="st">if</span><span class="sy">(</span><span class="e">in_array</span><span class="sy">(</span><span class="s">"-1"</span><span class="sy">,</span><span class="h"> </span><span class="v">$index</span><span class="sy">)</span><span class="h"> </span><span class="o">||</span><span class="h"> </span><span class="e">in_array</span><span class="sy">(</span><span class="v">$i</span><span class="sy">,</span><span class="h"> </span><span class="v">$index</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-445"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-446"><span class="v">$stat</span><span class="sy">[</span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">ExtractFile</span><span class="sy">(</span><span class="v">$header</span><span class="sy">,</span><span class="h"> </span><span class="v">$to</span><span class="sy">,</span><span class="h"> </span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-447"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-448"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-449">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-450"><span class="e">fclose</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-451"><span class="k ">return</span><span class="h"> </span><span class="v">$stat</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-452"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-453">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-454"><span class="c">/**********************************************************</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-455"><span class="c">* 其它部分</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-456"><span class="c">**********************************************************/</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-457"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-458"><span class="c">// #获取被压缩文件的信息</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-459"><span class="c">//</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-460"><span class="c">// $archive = new PHPZip();</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-461"><span class="c">// $array = $archive-&gt;GetZipInnerFilesInfo(ZIP压缩文件名);</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-462"><span class="c">// for($i=0; $i&lt;count($array); $i++) {</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-463"><span class="c">// printf("&lt;b&gt;&amp;middot;%s&lt;/b&gt;&lt;br&gt;\r\n", $array[$i][filename]);</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-464"><span class="c">// foreach($array[$i] as $key =&gt; $value)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-465"><span class="c">// printf("%s =&gt; %s&lt;br&gt;\r\n", $key, $value);</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-466"><span class="c">// print "\r\n&lt;p&gt;------------------------------------&lt;p&gt;\r\n\r\n";</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-467"><span class="c">// }</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-468"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-469"><span class="m">public</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">GetZipInnerFilesInfo</span><span class="sy">(</span><span class="v">$zipfile</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-470"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-471"><span class="v">$zip</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">@</span><span class="e">fopen</span><span class="sy">(</span><span class="v">$zipfile</span><span class="sy">,</span><span class="h"> </span><span class="s">'rb'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-472"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">(</span><span class="cn">0</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-473"><span class="v">$centd</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">ReadCentralDir</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$zipfile</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-474">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-475"><span class="sy">@</span><span class="e">rewind</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-476"><span class="sy">@</span><span class="e">fseek</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$centd</span><span class="sy">[</span><span class="s">'offset'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-477"><span class="v">$ret</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="t">array</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-478">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-479"><span class="st">for</span><span class="sy">(</span><span class="v">$i</span><span class="o">=</span><span class="cn">0</span><span class="sy">;</span><span class="h"> </span><span class="v">$i</span><span class="o">&lt;</span><span class="v">$centd</span><span class="sy">[</span><span class="s">'entries'</span><span class="sy">]</span><span class="sy">;</span><span class="h"> </span><span class="v">$i</span><span class="o">++</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-480"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-481"><span class="v">$header</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">ReadCentralFileHeaders</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-482"><span class="v">$header</span><span class="sy">[</span><span class="s">'index'</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$i</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-483"><span class="v">$info</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="t">array</span><span class="sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-484"><span class="s">'filename'</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'filename'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="c">// 文件名</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-485"><span class="s">'stored_filename'</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'stored_filename'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="c">// 压缩后文件名</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-486"><span class="s">'size'</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'size'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="c">// 大小</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-487"><span class="s">'compressed_size'</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'compressed_size'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="c">// 压缩后大小</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-488"><span class="s">'crc'</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="e">strtoupper</span><span class="sy">(</span><span class="e">dechex</span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'crc'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">)</span><span class="sy">,</span><span class="h"> </span><span class="c">// CRC32</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-489"><span class="s">'mtime'</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="e">date</span><span class="sy">(</span><span class="s">"Y-m-d H:i:s"</span><span class="sy">,</span><span class="v">$header</span><span class="sy">[</span><span class="s">'mtime'</span><span class="sy">]</span><span class="sy">)</span><span class="sy">,</span><span class="h"> </span><span class="c">// 文件修改时间</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-490"><span class="s">'comment'</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'comment'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="c">// 注释</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-491"><span class="s">'folder'</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="sy">(</span><span class="v">$header</span><span class="sy">[</span><span class="s">'external'</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">0x41FF0010</span><span class="h"> </span><span class="o">||</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'external'</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">16</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="cn">0</span><span class="sy">,</span><span class="h"> </span><span class="c">// 是否为文件夹</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-492"><span class="s">'index'</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'index'</span><span class="sy">]</span><span class="sy">,</span><span class="h"> </span><span class="c">// 文件索引</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-493"><span class="s">'status'</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="v">$header</span><span class="sy">[</span><span class="s">'status'</span><span class="sy">]</span><span class="h"> </span><span class="c">// 状态</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-494"><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-495"><span class="v">$ret</span><span class="sy">[</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$info</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-496"><span class="k ">unset</span><span class="sy">(</span><span class="v">$header</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-497"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-498"><span class="e">fclose</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-499"><span class="k ">return</span><span class="h"> </span><span class="v">$ret</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-500"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-501">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-502"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-503"><span class="c">// #获取压缩文件的注释</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-504"><span class="c">//</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-505"><span class="c">// $archive = new PHPZip();</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-506"><span class="c">// echo $archive-&gt;GetZipComment(ZIP压缩文件名);</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-507"><span class="c">// ------------------------------------------------------ //</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-508"><span class="m">public</span><span class="h"> </span><span class="t">function</span><span class="h"> </span><span class="e">GetZipComment</span><span class="sy">(</span><span class="v">$zipfile</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-509"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-510"><span class="v">$zip</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">@</span><span class="e">fopen</span><span class="sy">(</span><span class="v">$zipfile</span><span class="sy">,</span><span class="h"> </span><span class="s">'rb'</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-511"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">{</span><span class="h"> </span><span class="k ">return</span><span class="sy">(</span><span class="cn">0</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-512"><span class="v">$centd</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$this</span><span class="o">-&gt;</span><span class="e">ReadCentralDir</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">,</span><span class="h"> </span><span class="v">$zipfile</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-513"><span class="e">fclose</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-514"><span class="k ">return</span><span class="h"> </span><span class="v">$centd</span><span class="sy">[</span><span class="i">comment</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-515"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-516"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-517"><span class="ta">?&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-518">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-519"><span class="o">&lt;</span><span class="e">form </span><span class="i">method</span><span class="o">=</span><span class="s">"post"</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-520">压缩到服务器<span class="o">:</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-521"><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-522">压缩目录<span class="o">:</span>　　　　　<span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"zipdir"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"text"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"zipdir"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span><span class="sy">(</span>例如<span class="sy">.</span><span class="o">/</span><span class="i">folder</span><span class="sy">)</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-523">另存为路径和文件名<span class="o">:</span><span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"savename"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"text"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"savename"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span><span class="sy">(</span>例如<span class="sy">.</span><span class="o">/</span><span class="i">folder</span><span class="o">/</span><span class="i">file</span><span class="sy">.</span><span class="i">zip</span><span class="sy">)</span><span class="sy">(</span>需要填写扩展名<span class="sy">)</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-524"><span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"zip"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"submit"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"zip"</span><span class="h"> </span><span class="i">value</span><span class="o">=</span><span class="s">"压缩"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-525"><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-526">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-527">压缩并下载</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-528"><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-529">文件所在目录<span class="o">:</span><span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"zipdowndir"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"text"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"zipdowndir"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span><span class="sy">(</span>例如<span class="sy">.</span><span class="o">/</span><span class="i">folder</span><span class="sy">)</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-530"><span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"zipdown"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"submit"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"zipdown"</span><span class="h"> </span><span class="i">value</span><span class="o">=</span><span class="s">"压缩并下载"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-531"><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-532">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-533">在线解压<span class="i">zip</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-534"><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-535">文件<span class="o">:</span>　<span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"unzipfile"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"text"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"unzipfile"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span><span class="sy">(</span>例如<span class="sy">.</span><span class="o">/</span><span class="i">folder</span><span class="o">/</span><span class="i">file</span><span class="sy">.</span><span class="i">zip</span><span class="sy">)</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-536">解压到<span class="o">:</span><span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"unziptarget"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"text"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"unziptarget"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span><span class="sy">(</span>例如<span class="sy">.</span><span class="o">/</span><span class="i">folder</span><span class="sy">)</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-537"><span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"unzip"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"submit"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"unzip"</span><span class="h"> </span><span class="i">value</span><span class="o">=</span><span class="s">"解压"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-538"><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-539">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-540">读取压缩文件内部文件信息和注释</div><div class="crayon-line" id="crayon-53d2e08099fc1-541"><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">--</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-542">文件<span class="o">:</span><span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"readfile"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"text"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"readfile"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span><span class="sy">(</span>例如<span class="sy">.</span><span class="o">/</span><span class="i">folder</span><span class="o">/</span><span class="i">file</span><span class="sy">.</span><span class="i">zip</span><span class="sy">)</span><span class="o">&lt;</span><span class="i">br</span><span class="o">&gt;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-543"><span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"readfileinfo"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"submit"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"readfileinfo"</span><span class="h"> </span><span class="i">value</span><span class="o">=</span><span class="s">"读取内部文件信息"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-544"><span class="o">&lt;</span><span class="e">input </span><span class="i">name</span><span class="o">=</span><span class="s">"readcomment"</span><span class="h"> </span><span class="i">type</span><span class="o">=</span><span class="s">"submit"</span><span class="h"> </span><span class="i">id</span><span class="o">=</span><span class="s">"readcomment"</span><span class="h"> </span><span class="i">value</span><span class="o">=</span><span class="s">"读取注释"</span><span class="h"> </span><span class="o">/</span><span class="o">&gt;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-545"><span class="o">&lt;</span><span class="o">/</span><span class="e">form</span><span class="o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-546"><span class="ta">&lt;?</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-547"><span class="k ">echo</span><span class="h"> </span><span class="s">"&lt;p&gt;&lt;p&gt;\r\n"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-548"><span class="k ">echo</span><span class="h"> </span><span class="s">"&lt;br&gt;--------------------------&lt;br&gt;\r\n"</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-549"><span class="k ">echo</span><span class="h"> </span><span class="s">"显示信息:\r\n"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-550"><span class="k ">echo</span><span class="h"> </span><span class="s">"&lt;br&gt;--------------------------&lt;br&gt;\r\n"</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-551"><span class="e">extract</span><span class="sy">(</span><span class="v">$_POST</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-552"><span class="v">$archive</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="r">new</span><span class="h"> </span><span class="e">PHPZip</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-553"><span class="st">if</span><span class="sy">(</span><span class="o">!</span><span class="k ">empty</span><span class="sy">(</span><span class="v">$zip</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-554"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-555"><span class="v">$archive</span><span class="o">-&gt;</span><span class="e">Zip</span><span class="sy">(</span><span class="v">$zipdir</span><span class="sy">,</span><span class="h"> </span><span class="v">$savename</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-556"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-557"><span class="st">elseif</span><span class="sy">(</span><span class="o">!</span><span class="k ">empty</span><span class="sy">(</span><span class="v">$zipdown</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-558"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-559"><span class="v">$archive</span><span class="o">-&gt;</span><span class="e">ZipAndDownload</span><span class="sy">(</span><span class="v">$zipdowndir</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-560"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-561"><span class="st">elseif</span><span class="sy">(</span><span class="o">!</span><span class="k ">empty</span><span class="sy">(</span><span class="v">$unzip</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-562"><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-563"><span class="v">$zipfile</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$unzipfile</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-564"><span class="v">$savepath</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$unziptarget</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-565"><span class="v">$array</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$archive</span><span class="o">-&gt;</span><span class="e">GetZipInnerFilesInfo</span><span class="sy">(</span><span class="v">$zipfile</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-566"><span class="v">$filecount</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-567"><span class="v">$dircount</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-568"><span class="v">$failfiles</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="t">array</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-569"><span class="e">set_time_limit</span><span class="sy">(</span><span class="cn">0</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="c">// 修改为不限制超时时间(默认为30秒)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-570">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-571"><span class="st">for</span><span class="sy">(</span><span class="v">$i</span><span class="o">=</span><span class="cn">0</span><span class="sy">;</span><span class="h"> </span><span class="v">$i</span><span class="o">&lt;</span><span class="e">count</span><span class="sy">(</span><span class="v">$array</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="v">$i</span><span class="o">++</span><span class="sy">)</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-572"><span class="st">if</span><span class="sy">(</span><span class="v">$array</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="sy">[</span><span class="i">folder</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-573"><span class="st">if</span><span class="sy">(</span><span class="v">$archive</span><span class="o">-&gt;</span><span class="e">unZip</span><span class="sy">(</span><span class="v">$zipfile</span><span class="sy">,</span><span class="h"> </span><span class="v">$savepath</span><span class="sy">,</span><span class="h"> </span><span class="v">$i</span><span class="sy">)</span><span class="h"> </span><span class="o">&gt;</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-574"><span class="v">$filecount</span><span class="o">++</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-575"><span class="sy">}</span><span class="st">else</span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-576"><span class="v">$failfiles</span><span class="sy">[</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$array</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="sy">[</span><span class="i">filename</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-577"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-578"><span class="sy">}</span><span class="st">else</span><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-579"><span class="v">$dircount</span><span class="o">++</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-580"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-581"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-582">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-583"><span class="e">set_time_limit</span><span class="sy">(</span><span class="cn">30</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-584">&nbsp;</div><div class="crayon-line" id="crayon-53d2e08099fc1-585"><span class="e">printf</span><span class="sy">(</span><span class="s">"文件夹:%d&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;解压文件:%d&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;失败:%d&lt;br&gt;\r\n"</span><span class="sy">,</span><span class="h"> </span><span class="v">$dircount</span><span class="sy">,</span><span class="h"> </span><span class="v">$filecount</span><span class="sy">,</span><span class="h"> </span><span class="e">count</span><span class="sy">(</span><span class="v">$failfiles</span><span class="sy">)</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-586"><span class="st">if</span><span class="sy">(</span><span class="e">count</span><span class="sy">(</span><span class="v">$failfiles</span><span class="sy">)</span><span class="h"> </span><span class="o">&gt;</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="sy">{</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-587"><span class="st">foreach</span><span class="sy">(</span><span class="v">$failfiles</span><span class="h"> </span><span class="st">as</span><span class="h"> </span><span class="v">$file</span><span class="sy">)</span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-588"><span class="e">printf</span><span class="sy">(</span><span class="s">"&amp;middot;%s&lt;br&gt;\r\n"</span><span class="sy">,</span><span class="h"> </span><span class="v">$file</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-589"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-590"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-591"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-592"><span class="st">elseif</span><span class="sy">(</span><span class="o">!</span><span class="k ">empty</span><span class="sy">(</span><span class="v">$readfileinfo</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-593"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-594"><span class="v">$array</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$archive</span><span class="o">-&gt;</span><span class="e">GetZipInnerFilesInfo</span><span class="sy">(</span><span class="v">$readfile</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-595"><span class="st">for</span><span class="sy">(</span><span class="v">$i</span><span class="o">=</span><span class="cn">0</span><span class="sy">;</span><span class="h"> </span><span class="v">$i</span><span class="o">&lt;</span><span class="e">count</span><span class="sy">(</span><span class="v">$array</span><span class="sy">)</span><span class="sy">;</span><span class="h"> </span><span class="v">$i</span><span class="o">++</span><span class="sy">)</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-596"><span class="e">printf</span><span class="sy">(</span><span class="s">"&lt;b&gt;&amp;middot;%s&lt;/b&gt;&lt;br&gt;\r\n"</span><span class="sy">,</span><span class="h"> </span><span class="v">$array</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="sy">[</span><span class="i">filename</span><span class="sy">]</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-597"><span class="st">foreach</span><span class="sy">(</span><span class="v">$array</span><span class="sy">[</span><span class="v">$i</span><span class="sy">]</span><span class="h"> </span><span class="st">as</span><span class="h"> </span><span class="v">$key</span><span class="h"> </span><span class="o">=</span><span class="o">&gt;</span><span class="h"> </span><span class="v">$value</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-598"><span class="e">printf</span><span class="sy">(</span><span class="s">"%s =&gt; %s&lt;br&gt;\r\n"</span><span class="sy">,</span><span class="h"> </span><span class="v">$key</span><span class="sy">,</span><span class="h"> </span><span class="v">$value</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-599"><span class="k ">print</span><span class="h"> </span><span class="s">"\r\n&lt;p&gt;------------------------------------&lt;p&gt;\r\n\r\n"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-600"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-601"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-602"><span class="st">elseif</span><span class="sy">(</span><span class="o">!</span><span class="k ">empty</span><span class="sy">(</span><span class="v">$readcomment</span><span class="sy">)</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-603"><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-604"><span class="v">$comment</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">$archive</span><span class="o">-&gt;</span><span class="e">GetZipComment</span><span class="sy">(</span><span class="v">$readfile</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-605"><span class="e">printf</span><span class="sy">(</span><span class="s">"%s&lt;br&gt;\r\n"</span><span class="sy">,</span><span class="h"> </span><span class="v">$comment</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53d2e08099fc1-606"><span class="sy">}</span></div><div class="crayon-line" id="crayon-53d2e08099fc1-607"><span class="ta">?&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 1.1256 seconds] -->
<p>本文链接：<a title="php又一个zip压缩和解压缩实现" href="http://www.521php.com/archives/532/" target="_blank">http://www.521php.com/archives/532/</a></p>
                        <p style="color:#17750A;"><b>程序本天成，妙手偶得之！</b></p>
                         <p>转载请注明：<a href="http://www.521php.com/archives/532/" title="php又一个zip压缩和解压缩实现" target="_blank">http://www.521php.com/archives/532/</a></p>
                        </div>
                  </div><!--toolBar-->
                    <div class="toolBar toolBarTwo">
                    	<UL>
                            <li class="mrinc2 tags2">Tags:<a href="http://www.521php.com/archives/tag/php/" rel="tag">php</a>,<a href="http://www.521php.com/archives/tag/zip/" rel="tag">zip</a>,<a href="http://www.521php.com/archives/tag/hanshu/" rel="tag">函数</a>,<a href="http://www.521php.com/archives/tag/class/" rel="tag">类</a></li>
                            <LI class="mrinc2 share_r" onmouseover=share_more(532,this);><A href="javascript:;">分享到...</A> </LI>
                        </UL>
                    </div>
                    <SCRIPT>postArray[532]=[];postArray[532][0]="php又一个zip压缩和解压缩实现";postArray[532][1]="http://www.521php.com/archives/532/";postArray[532][2]="";postArray[532][3]="http://www.521php.com/wp-content/themes/zeke/img/default.gif";</SCRIPT>
           		</div>
                <div class="content_t_bot"><!--样式尾部--></div>
                </div>
            <div class="navigation">
				<p class="navNew"><a href="http://www.521php.com/archives/537/" rel="next">js实现地区的二、三级联动</a></p>
				<p class="navOld"><a href="http://www.521php.com/archives/530/" rel="prev">php即点即改实现</a></p>
	    </div>
           
           <div class="content_text">
               <div class="content_t_top"></div>
               <div class="content_t_main"> <div class="ujian-hook"></div></div>
	       <div class="content_t_bot"><!--样式尾部--></div>
	   </div>
	   <div class="content_text">
               <div class="content_t_top"></div>
               <div class="content_t_main">
               <div class="xgwz">
	       <div>相关文章</div>
			<li><span class="xtitle"><a href="http://www.521php.com/archives/510/" rel="bookmark" title="php将access数据导入mysql数据库">php将access数据导入mysql数据库</a></span> <span class="xtag">2012-09-20 <a href="http://www.521php.com/archives/category/gongneng/" title="查看 小功能 中的全部文章" rel="category tag">小功能</a>/<a href="http://www.521php.com/archives/category/lovephp/" title="查看 我爱PHP 中的全部文章" rel="category tag">我爱PHP</a>/<a href="http://www.521php.com/archives/category/tj/" title="查看 推荐文章 中的全部文章" rel="category tag">推荐文章</a></span></li>
<li><span class="xtitle"><a href="http://www.521php.com/archives/1187/" rel="bookmark" title="织梦内置标签小优化之四—dede:channelartlist标签">织梦内置标签小优化之四—dede:channelartlist标签</a></span> <span class="xtag">2013-04-03 <a href="http://www.521php.com/archives/category/gongneng/" title="查看 小功能 中的全部文章" rel="category tag">小功能</a>/<a href="http://www.521php.com/archives/category/zong/" title="查看 总结 中的全部文章" rel="category tag">总结</a>/<a href="http://www.521php.com/archives/category/lovephp/" title="查看 我爱PHP 中的全部文章" rel="category tag">我爱PHP</a>/<a href="http://www.521php.com/archives/category/tj/" title="查看 推荐文章 中的全部文章" rel="category tag">推荐文章</a></span></li>
<li><span class="xtitle"><a href="http://www.521php.com/archives/149/" rel="bookmark" title="php获取用户的真实ip">php获取用户的真实ip</a></span> <span class="xtag">2012-07-06 <a href="http://www.521php.com/archives/category/lovephp/" title="查看 我爱PHP 中的全部文章" rel="category tag">我爱PHP</a></span></li>
<li><span class="xtitle"><a href="http://www.521php.com/archives/324/" rel="bookmark" title="递归创建和删除指定文件下的所有东西">递归创建和删除指定文件下的所有东西</a></span> <span class="xtag">2012-08-17 <a href="http://www.521php.com/archives/category/lovephp/" title="查看 我爱PHP 中的全部文章" rel="category tag">我爱PHP</a>/<a href="http://www.521php.com/archives/category/tj/" title="查看 推荐文章 中的全部文章" rel="category tag">推荐文章</a></span></li>
<li><span class="xtitle"><a href="http://www.521php.com/archives/367/" rel="bookmark" title="php生成快捷方式！">php生成快捷方式！</a></span> <span class="xtag">2012-08-30 <a href="http://www.521php.com/archives/category/team/" title="查看 博采众长 中的全部文章" rel="category tag">博采众长</a>/<a href="http://www.521php.com/archives/category/gongneng/" title="查看 小功能 中的全部文章" rel="category tag">小功能</a>/<a href="http://www.521php.com/archives/category/lovephp/" title="查看 我爱PHP 中的全部文章" rel="category tag">我爱PHP</a></span></li>
<li><span class="xtitle"><a href="http://www.521php.com/archives/483/" rel="bookmark" title="关于博客建设的一些小建议">关于博客建设的一些小建议</a></span> <span class="xtag">2012-09-16 <a href="http://www.521php.com/archives/category/zong/" title="查看 总结 中的全部文章" rel="category tag">总结</a>/<a href="http://www.521php.com/archives/category/else/" title="查看 杂谈 中的全部文章" rel="category tag">杂谈</a></span></li>
<li><span class="xtitle"><a href="http://www.521php.com/archives/217/" rel="bookmark" title="织梦的当前页导航样式添加">织梦的当前页导航样式添加</a></span> <span class="xtag">2012-07-11 <a href="http://www.521php.com/archives/category/team/" title="查看 博采众长 中的全部文章" rel="category tag">博采众长</a>/<a href="http://www.521php.com/archives/category/lovephp/" title="查看 我爱PHP 中的全部文章" rel="category tag">我爱PHP</a></span></li>
<li><span class="xtitle"><a href="http://www.521php.com/archives/471/" rel="bookmark" title="wordpress在内容页增加随机相关文章">wordpress在内容页增加随机相关文章</a></span> <span class="xtag">2012-09-13 <a href="http://www.521php.com/archives/category/team/" title="查看 博采众长 中的全部文章" rel="category tag">博采众长</a>/<a href="http://www.521php.com/archives/category/lovephp/" title="查看 我爱PHP 中的全部文章" rel="category tag">我爱PHP</a>/<a href="http://www.521php.com/archives/category/tj/" title="查看 推荐文章 中的全部文章" rel="category tag">推荐文章</a></span></li>
<li><span class="xtitle"><a href="http://www.521php.com/archives/1672/" rel="bookmark" title="FastCgi与PHP-fpm之间的关系">FastCgi与PHP-fpm之间的关系</a></span> <span class="xtag">2014-04-12 <a href="http://www.521php.com/archives/category/team/" title="查看 博采众长 中的全部文章" rel="category tag">博采众长</a>/<a href="http://www.521php.com/archives/category/zong/" title="查看 总结 中的全部文章" rel="category tag">总结</a></span></li>
<li><span class="xtitle"><a href="http://www.521php.com/archives/314/" rel="bookmark" title="dedecms标签的学习">dedecms标签的学习</a></span> <span class="xtag">2012-08-14 <a href="http://www.521php.com/archives/category/team/" title="查看 博采众长 中的全部文章" rel="category tag">博采众长</a>/<a href="http://www.521php.com/archives/category/lovephp/" title="查看 我爱PHP 中的全部文章" rel="category tag">我爱PHP</a></span></li>
</div>
           <div class="content_t_bot"></div>
	   </div>
<!-- You can start editing here. -->
<div id="comment_body">
	<h4 id="comments">目前有2 条留言</h4>
	<ol class="comment_list" id="comment_list">
	   <li class="comment even thread-even depth-1" id="comment-101"><div class="excerpt"><div class="excerpt_top"></div>
   <div class="excerpt_main">
      
   <div class="commentItem" id="div-comment-101">
   	<div class="commentAvatar"><img src='http://www.521php.com/avatar/4d941acd01f493b0f7c9d24ad9c567b8.jpg' alt='' class='avatar' /></div>
    <div class="commentContent">
    		<p class="commentHead "><span class="datetime">2012年09月25日 上午 11:05</span><span class="author">						<a id="commentauthor-101" href="http://www.shankunet.com/" rel="external nofollow" title="变形吧" target="_blank">
											变形吧											</a>
					</span><span class="actions">&nbsp; | &nbsp;<a href="javascript:void(0);" onclick="MGJS_CMT.quote('commentauthor-101', 'comment-101', 'commentbody-101', 'comment');">引用</a>&nbsp; | &nbsp;<a href="#comment-101">#1</a>&nbsp; &nbsp; &nbsp;</span></p>
			<div class="commentBody"><p>&lt;?php echo &quot;&#8221;?&gt;<br />
&lt;?php echo &quot;&#8221;?&gt;</p>
<p>/***/</p>
</div>
			<div class="commentFoot"><span class="reply"><a class='comment-reply-link' href='/archives/532/?replytocom=101#respond' onclick='return addComment.moveForm("div-comment-101", "101", "respond", "532")'>[回复]</a></span></div>
            <div class="clear"></div>
    </div>
</div>
<ul class='children'>
   <li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="comment-102"><div class="excerpt"><div class="excerpt_top"></div>
   <div class="excerpt_main">
      
   <div class="commentItem" id="div-comment-102">
   	<div class="commentAvatar"><img src='http://www.521php.com/avatar/47e41416c5c18f88f56796c0f6065374.jpg' alt='' class='avatar' /></div>
    <div class="commentContent">
    		<p class="commentHead "><span class="datetime">2012年09月25日 下午 1:41</span><span class="author">						<a id="commentauthor-102" href="http://www.521php.com" rel="external nofollow" title="地狱中仰望天堂" target="_blank">
											地狱中仰望天堂											</a>
					</span><span class="actions">&nbsp; | &nbsp;<a href="javascript:void(0);" onclick="MGJS_CMT.quote('commentauthor-102', 'comment-102', 'commentbody-102', 'comment');">引用</a>&nbsp; | &nbsp;<a href="#comment-102">#2</a>&nbsp; &nbsp; &nbsp;</span></p>
			<div class="commentBody"><p>没事的，我用了pre，可以直接复制</p>
</div>
			<div class="commentFoot"><span class="reply"><a class='comment-reply-link' href='/archives/532/?replytocom=102#respond' onclick='return addComment.moveForm("div-comment-102", "102", "respond", "532")'>[回复]</a></span></div>
            <div class="clear"></div>
    </div>
</div>
</div><div class="excerpt_bot"></div></div></li></ul>
</div><div class="excerpt_bot"></div></div></li>	</ol>
 	</div>
<div class="navigation_comments">
		<div class="pagination"></div>
</div>
  <div id="respond">
            	<div class="excerpt_top"></div>
                <div class="excerpt_main">
<h3 class="givetext">发表评论</h3>
<div class="cancel-comment-reply">
		<!--<div id="real-avatar">
			<img alt='' src='http://0.gravatar.com/avatar/?d=http://www.521php.com/wp-content/themes/zeke/MRimg/gravatar.png&amp;s=40' class='avatar avatar-40 photo avatar-default' height='40' width='40' />	</div>-->
			<small><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/532/#respond" style="display:none;">点击这里取消回复。</a></small>
		</div>
<form action="http://www.521php.com/wp-comments-post.php" method="post" id="commentform">
<div class="form_box">
<div class="form_infobody">
 	<div id="comment-author-info" class="form_info">
		<div class="author">昵称：<input type="text" class="textfield" name="author" id="author" tabindex="1" value=""></div>
        <p style="height:15px"></p>
		<div class="email">邮箱：<input type="text" class="textfield" name="email" id="email" tabindex="2" value=""></div>
        <p style="height:15px"></p>
		<div class="url">网址：<input type="text" class="textfield" name="url" id="url" tabindex="3" value=""></div>
    </div>
</div>
    <div class="form_text"><textarea name="comment" id="comment" class="textarea"  tabindex="4"  onfocus="if (this.value == 'Make Comments on this Article') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Make Comments on this Article';}">Make Comments on this Article</textarea></div>
</div>
<p></p>
<div class="ajax_box" id="comment_jstext">eg.博客主题调用的是Gravatar头像,你可以通过邮箱注册获得头像.</div>
<div class="form_btn">
<div class="submit_box"><div class="aLeft"><input class="submit" name="submit" type="submit" id="submit" tabindex="5" value="提交留言"><input class="reset" name="reset" type="reset" id="reset" tabindex="6" value="重写"></div><div class="aRight"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked" style="margin-left:0px;" /><label for="comment_mail_notify" style="display: inline;">有人回复时邮件通知我</label> / 快捷键：Ctrl+Enter</label><input type='hidden' name='comment_post_ID' value='532' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</div></div>
</div>
<script type="text/javascript">	//Crel+Enter
			$(document).keypress(function(e){
				if(e.ctrlKey && e.which == 13 || e.which == 10) { 
					$(".submit").click();
					document.body.focus();
				} else if (e.shiftKey && e.which==13 || e.which == 10) {
					$(".submit").click();
				}          
			})
		</script>
</form>
                </div>
                <div class="excerpt_bot"></div>
            </div>
</div>
        </div>
        <div id="sidebar">
			<!--自我介绍-->
			<div class="sidebar_body">
           	  <div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg">
                            <H3>本站公告</H3>
                        </div>
                    </div>
                    <div class="sid_body"><div><img src="http://www.521php.com/wp-content/themes/zeke/fly.gif" width="200" height="180" /></div>
					<p style="text-align:left; font-size:12px;">程序本天成，妙手偶得之！
<br />趣赔集团刚成立，如果您想投资可直接转入支付宝，和我联系<br /><script>document.write('<a href="http://www.521php.com/payme/" target="_blank"><img src="/wp-content/themes/zeke/btn-index.png" height="40" /></a>');</script> <img src="/wp-content/themes/zeke/gx.gif" height="40" />			
					</p>
                    </div>
                </div>
                <div class="sidebar_b_bot"><!--样式尾部--></div>
            </div>
			<!--日志分类-->

        	<div class="sidebar_body">
           	  <div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg">
                            <H3>文章分类</H3>
                        </div>
                    </div>
                    <div class="sid_body">
                    	<ul class="sid_lm">
                        		<li class="cat-item cat-item-61"><a href="http://www.521php.com/archives/category/linux/" title="linux服务器">Linux</a> (16)
</li>
	<li class="cat-item cat-item-15"><a href="http://www.521php.com/archives/category/wordpress/" title="在其位，谋其政！">WordPress</a> (8)
</li>
	<li class="cat-item cat-item-41"><a href="http://www.521php.com/archives/category/team/" title="取长补短，好的学习习惯可以让我们少走很多弯路！">博采众长</a> (68)
</li>
	<li class="cat-item cat-item-71"><a href="http://www.521php.com/archives/category/safe/" title="查看 安全 下的所有文章">安全</a> (7)
</li>
	<li class="cat-item cat-item-52"><a href="http://www.521php.com/archives/category/gongneng/" title="查看 小功能 下的所有文章">小功能</a> (55)
</li>
	<li class="cat-item cat-item-12"><a href="http://www.521php.com/archives/category/zong/" title="合理的总结我们的工作，工作就是学习！">总结</a> (62)
</li>
	<li class="cat-item cat-item-10"><a href="http://www.521php.com/archives/category/lovephp/" title="我们共同的php技术博客！总结php知识，交流php编程心得！">我爱PHP</a> (127)
</li>
	<li class="cat-item cat-item-70"><a href="http://www.521php.com/archives/category/tj/" title="查看 推荐文章 下的所有文章">推荐文章</a> (71)
</li>
	<li class="cat-item cat-item-46"><a href="http://www.521php.com/archives/category/else/" title="读书心得，视频感悟，社会舆论，杂七杂八">杂谈</a> (31)
</li>
	<li class="cat-item cat-item-4"><a href="http://www.521php.com/archives/category/cclog/" title="我们不知道人生到底有多长，但是我知道当我们回首看这些的时候一定会深深的感动！">随笔</a> (33)
</li>
                        </ul>
                    </div>
                </div>
                <div class="sidebar_b_bot"><!--样式尾部--></div>
            </div>

	    			<div class="sidebar_body">
           	  <div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg">
                            <H3><a href="/tg/" title="进入本站推广">进入本站推广</a></H3>
                        </div>
                    </div>
                    <div class="sid_body" align="center">
<iframe name="alimamaifrm" frameborder="0" marginheight="0" marginwidth="0" border="0" scrolling="no" width="210" height="200" src="http://www.taobao.com/go/app/tbk_app/chongzhi_210_200.php?pid=mm_30958902_3426892_13314114&page=chongzhi_210_200.php&size_w=210&size_h=200&stru_phone=1&stru_game=1&stru_travel=1" ></iframe>
                    </div>
                </div>
                <div class="sidebar_b_bot"><!--样式尾部--></div>
            </div>
<!--本站接口-->
            <div class="sidebar_body">
           	  <div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg">
                            <H3>本站接口</H3>
                        </div>
                    </div>
                    <div class="sid_body">
                    	<ul class="sid_link_text">
                        <li><a href="http://www.521php.com/api/pinyin.php" title="php将中文转化为拼音接口" target="_blank">php将中文转化为拼音接口</a></li>
<li><a href="http://www.521php.com/api/ip.php" title="php获取ip归属地接口" target="_blank">php获取ip归属地接口</a></li>
<li><a href="http://www.521php.com/archives/913/" title="百度谷歌一起搜接口" target="_blank">百度谷歌一起搜接口</a></li>
<li><a href="http://www.521php.com/api/qr/" title="二维码在线生成工具" target="_blank">二维码在线生成工具</a></li>
<li><a href="http://www.521php.com/api/fenci/" title="php智能分词功能" target="_blank">php智能分词功能</a></li>
<li><a href="http://www.521php.com/api/fav/" title="获取指定网站favicon.ico图标接口" target="_blank">获取指定网站favicon.ico图标接口</a></li>
<li><a href="http://www.521php.com/api/pr/" title="权重,pr,alexa及收录情况查询接口" target="_blank">权重,pr,alexa及收录情况查询接口</a></li>
<li><a href="http://www.521php.com/api/sl/" title="php扫雷小游戏" target="_blank">php扫雷小游戏</a></li>
                      </ul>
                    </div>
                </div>
                <div class="sidebar_b_bot"><!--样式尾部--></div>
            </div>
            <!--本站接口-->
            <!--博客归档OR最新文章OR随机日志-->
            <div class="sidebar_body">
           	  <div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg">
                            <H3><a href="/archives/category/tj/" title="推荐文章">推荐文章</a></H3>
                        </div>
                    </div>
                    <div class="sid_body">
                    	<ul class="sid_Archives sid_link_text">
<li><a href="http://www.521php.com/archives/1253/" title="外链自助上线了" rel="bookmark">
外链自助上线了</a></li>
<li><a href="http://www.521php.com/archives/996/" title="php捕捉各大搜索引擎的蜘蛛、爬虫记录" rel="bookmark">
php捕捉各大搜索引擎的蜘蛛、爬虫记录</a></li>
<li><a href="http://www.521php.com/archives/1365/" title="可逆的php字符加密算法" rel="bookmark">
可逆的php字符加密算法</a></li>
<li><a href="http://www.521php.com/archives/1728/" title="转-技术人员如何参与产品设计讨论：激活那一潭死水" rel="bookmark">
转-技术人员如何参与产品设计讨论：激活那一潭死水</a></li>
<li><a href="http://www.521php.com/archives/913/" title="本站百度和谷歌一起搜接口！(推荐)" rel="bookmark">
本站百度和谷歌一起搜接口！(推荐)</a></li>
<li><a href="http://www.521php.com/archives/1369/" title="php 自定义json_encode和json_decode函数" rel="bookmark">
php 自定义json_encode和json_decode函数</a></li>
<li><a href="http://www.521php.com/archives/682/" title="导医系统开发总结之自己的编程心得" rel="bookmark">
导医系统开发总结之自己的编程心得</a></li>
<li><a href="http://www.521php.com/archives/1203/" title="纯php代码实现伪静态的方法" rel="bookmark">
纯php代码实现伪静态的方法</a></li>
<li><a href="http://www.521php.com/archives/1187/" title="织梦内置标签小优化之四—dede:channelartlist标签" rel="bookmark">
织梦内置标签小优化之四—dede:channelartlist标签</a></li>
<li><a href="http://www.521php.com/archives/1172/" title="织梦内置标签小优化之二——dede:channel标签优化" rel="bookmark">
织梦内置标签小优化之二——dede:channel标签优化</a></li>
</ul>
                    </div>
                </div>
                <div class="sidebar_b_bot"><!--样式尾部--></div>
            </div>
			<div class="sidebar_body">
           	  <div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg">
                            <H3><a href="/archives/category/lovephp/" title="技术心得">学习之所得</a></H3>
                        </div>
                    </div>
                    <div class="sid_body">
                    	<ul class="sid_Archives sid_link_text">
<li><a href="http://www.521php.com/archives/1752/" title="php脚本实现redis数据库指定库号迁移" rel="bookmark">
php脚本实现redis数据库指定库号迁移</a></li>
<li><a href="http://www.521php.com/archives/1746/" title="php批量去除指定目录的bom头" rel="bookmark">
php批量去除指定目录的bom头</a></li>
<li><a href="http://www.521php.com/archives/1739/" title="一键式虚拟主机搭建shell脚本" rel="bookmark">
一键式虚拟主机搭建shell脚本</a></li>
<li><a href="http://www.521php.com/archives/1735/" title="shell脚本做nginx日志分析工具" rel="bookmark">
shell脚本做nginx日志分析工具</a></li>
<li><a href="http://www.521php.com/archives/1722/" title="MySql避免全表扫描" rel="bookmark">
MySql避免全表扫描</a></li>
<li><a href="http://www.521php.com/archives/1716/" title="linux下nginx,php运行用户和ftp用户权限分配" rel="bookmark">
linux下nginx,php运行用户和ftp用户权限分配</a></li>
<li><a href="http://www.521php.com/archives/1708/" title="php的pcntl_fork多进程小解" rel="bookmark">
php的pcntl_fork多进程小解</a></li>
<li><a href="http://www.521php.com/archives/1703/" title="鸟枪换大炮了" rel="bookmark">
鸟枪换大炮了</a></li>
<li><a href="http://www.521php.com/archives/1697/" title="两种方式实现js，ajax的跨域" rel="bookmark">
两种方式实现js，ajax的跨域</a></li>
<li><a href="http://www.521php.com/archives/1694/" title="redis小解及centos下php-redis扩展安装" rel="bookmark">
redis小解及centos下php-redis扩展安装</a></li>
</ul>
                    </div>
                </div>
                <div class="sidebar_b_bot"><!--样式尾部--></div>
            </div>
			
		<div class="sidebar_body">
           	  <div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg">
                            <H3><a href="/archives/category/cclog/" title="日志">生活之所感</a></H3>
                        </div>
                    </div>
                    <div class="sid_body">
                    	<ul class="sid_Archives sid_link_text">
<li><a href="http://www.521php.com/archives/1756/" title="4年了，给您汇报一下" rel="bookmark">
4年了，给您汇报一下</a></li>
<li><a href="http://www.521php.com/archives/1662/" title="近期的一点小感悟" rel="bookmark">
近期的一点小感悟</a></li>
<li><a href="http://www.521php.com/archives/1654/" title="不误正业" rel="bookmark">
不误正业</a></li>
<li><a href="http://www.521php.com/archives/1650/" title="论我的电脑为什么比别人的活的相对长久" rel="bookmark">
论我的电脑为什么比别人的活的相对长久</a></li>
<li><a href="http://www.521php.com/archives/1639/" title="没有正确的标题，只有正确的人" rel="bookmark">
没有正确的标题，只有正确的人</a></li>
<li><a href="http://www.521php.com/archives/1295/" title="阶段性小总结20130525" rel="bookmark">
阶段性小总结20130525</a></li>
<li><a href="http://www.521php.com/archives/1044/" title="职场白领的“攻薪技”" rel="bookmark">
职场白领的“攻薪技”</a></li>
<li><a href="http://www.521php.com/archives/1014/" title="天空海阔，要做最坚强的泡沫" rel="bookmark">
天空海阔，要做最坚强的泡沫</a></li>
<li><a href="http://www.521php.com/archives/985/" title="致师弟师妹的一封信" rel="bookmark">
致师弟师妹的一封信</a></li>
<li><a href="http://www.521php.com/archives/905/" title="2012年12月22日总结" rel="bookmark">
2012年12月22日总结</a></li>
</ul>
                    </div>
                </div>
                <div class="sidebar_b_bot"><!--样式尾部--></div>
            </div>
			<div class="sidebar_body">
           	  <div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg">
                            <H3><a href="/archives/category/else/" title="杂谈">杂七杂八</a></H3>
                        </div>
                    </div>
                    <div class="sid_body">
                    	<ul class="sid_Archives sid_link_text">
<li><a href="http://www.521php.com/archives/1728/" title="转-技术人员如何参与产品设计讨论：激活那一潭死水" rel="bookmark">
转-技术人员如何参与产品设计讨论：激活那一潭死水</a></li>
<li><a href="http://www.521php.com/archives/1654/" title="不误正业" rel="bookmark">
不误正业</a></li>
<li><a href="http://www.521php.com/archives/1650/" title="论我的电脑为什么比别人的活的相对长久" rel="bookmark">
论我的电脑为什么比别人的活的相对长久</a></li>
<li><a href="http://www.521php.com/archives/1384/" title="永远不要再犯的 5 个编程错误" rel="bookmark">
永远不要再犯的 5 个编程错误</a></li>
<li><a href="http://www.521php.com/archives/1381/" title="关于PHP的十大误解 你中了几个？" rel="bookmark">
关于PHP的十大误解 你中了几个？</a></li>
<li><a href="http://www.521php.com/archives/1270/" title="软件开发者的四大“看家本事”" rel="bookmark">
软件开发者的四大“看家本事”</a></li>
<li><a href="http://www.521php.com/archives/1263/" title="惹恼程序员的十件事" rel="bookmark">
惹恼程序员的十件事</a></li>
<li><a href="http://www.521php.com/archives/1260/" title="IT经验的七个总结" rel="bookmark">
IT经验的七个总结</a></li>
<li><a href="http://www.521php.com/archives/1057/" title="未来的八种人将被社会淘汰!" rel="bookmark">
未来的八种人将被社会淘汰!</a></li>
<li><a href="http://www.521php.com/archives/1044/" title="职场白领的“攻薪技”" rel="bookmark">
职场白领的“攻薪技”</a></li>
</ul>
                    </div>
                </div>
                <div class="sidebar_b_bot"><!--样式尾部--></div>
            </div>			
			 <!--调用标签云-->
			<div class="sidebar_body">
           	  <div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg">
                            <H3>标签云</H3>
                        </div>
                    </div>
<!--class="sid_body"-->
                    <div id="div1">
					<a href='http://www.521php.com/archives/tag/access/' class='tag-link-53' title='1 个话题' style='font-size: 12pt;'>access</a>
<a href='http://www.521php.com/archives/tag/ajax/' class='tag-link-57' title='7 个话题' style='font-size: 14.666666666667pt;'>ajax</a>
<a href='http://www.521php.com/archives/tag/apache/' class='tag-link-74' title='1 个话题' style='font-size: 12pt;'>apache</a>
<a href='http://www.521php.com/archives/tag/curl/' class='tag-link-63' title='1 个话题' style='font-size: 12pt;'>curl</a>
<a href='http://www.521php.com/archives/tag/dede/' class='tag-link-28' title='14 个话题' style='font-size: 15.911111111111pt;'>dede</a>
<a href='http://www.521php.com/archives/tag/discuz/' class='tag-link-64' title='1 个话题' style='font-size: 12pt;'>discuz</a>
<a href='http://www.521php.com/archives/tag/flash/' class='tag-link-59' title='1 个话题' style='font-size: 12pt;'>flash</a>
<a href='http://www.521php.com/archives/tag/gdku/' class='tag-link-32' title='2 个话题' style='font-size: 12.8pt;'>GD库</a>
<a href='http://www.521php.com/archives/tag/htaccess/' class='tag-link-69' title='1 个话题' style='font-size: 12pt;'>htaccess</a>
<a href='http://www.521php.com/archives/tag/jquery/' class='tag-link-55' title='1 个话题' style='font-size: 12pt;'>jquery</a>
<a href='http://www.521php.com/archives/tag/js/' class='tag-link-44' title='22 个话题' style='font-size: 16.711111111111pt;'>js</a>
<a href='http://www.521php.com/archives/tag/linux/' class='tag-link-61' title='17 个话题' style='font-size: 16.266666666667pt;'>Linux</a>
<a href='http://www.521php.com/archives/tag/mysql/' class='tag-link-79' title='2 个话题' style='font-size: 12.8pt;'>mysql</a>
<a href='http://www.521php.com/archives/tag/nginx/' class='tag-link-75' title='4 个话题' style='font-size: 13.777777777778pt;'>nginx</a>
<a href='http://www.521php.com/archives/tag/node/' class='tag-link-80' title='1 个话题' style='font-size: 12pt;'>node</a>
<a href='http://www.521php.com/archives/tag/php/' class='tag-link-3' title='125 个话题' style='font-size: 20pt;'>php</a>
<a href='http://www.521php.com/archives/tag/redis/' class='tag-link-77' title='3 个话题' style='font-size: 13.333333333333pt;'>redis</a>
<a href='http://www.521php.com/archives/tag/shell/' class='tag-link-81' title='3 个话题' style='font-size: 13.333333333333pt;'>shell</a>
<a href='http://www.521php.com/archives/tag/sql/' class='tag-link-43' title='4 个话题' style='font-size: 13.777777777778pt;'>sql</a>
<a href='http://www.521php.com/archives/tag/thrift/' class='tag-link-76' title='1 个话题' style='font-size: 12pt;'>thrift</a>
<a href='http://www.521php.com/archives/tag/wordpress/' class='tag-link-15' title='12 个话题' style='font-size: 15.6pt;'>WordPress</a>
<a href='http://www.521php.com/archives/tag/wp-postviews/' class='tag-link-20' title='2 个话题' style='font-size: 12.8pt;'>WP-PostViews</a>
<a href='http://www.521php.com/archives/tag/zip/' class='tag-link-56' title='2 个话题' style='font-size: 12.8pt;'>zip</a>
<a href='http://www.521php.com/archives/tag/zookeeper/' class='tag-link-73' title='1 个话题' style='font-size: 12pt;'>zookeeper</a>
<a href='http://www.521php.com/archives/tag/blog/' class='tag-link-51' title='42 个话题' style='font-size: 17.911111111111pt;'>个人博客</a>
<a href='http://www.521php.com/archives/tag/youhua/' class='tag-link-45' title='20 个话题' style='font-size: 16.533333333333pt;'>优化</a>
<a href='http://www.521php.com/archives/tag/hanshu/' class='tag-link-34' title='30 个话题' style='font-size: 17.288888888889pt;'>函数</a>
<a href='http://www.521php.com/archives/tag/fenye/' class='tag-link-11' title='2 个话题' style='font-size: 12.8pt;'>分页</a>
<a href='http://www.521php.com/archives/tag/bieming/' class='tag-link-24' title='2 个话题' style='font-size: 12.8pt;'>别名</a>
<a href='http://www.521php.com/archives/tag/danye/' class='tag-link-27' title='1 个话题' style='font-size: 12pt;'>单页</a>
<a href='http://www.521php.com/archives/tag/imgupload/' class='tag-link-26' title='2 个话题' style='font-size: 12.8pt;'>图片上传</a>
<a href='http://www.521php.com/archives/tag/imagemake/' class='tag-link-33' title='7 个话题' style='font-size: 14.666666666667pt;'>图片处理</a>
<a href='http://www.521php.com/archives/tag/yuming/' class='tag-link-18' title='5 个话题' style='font-size: 14.133333333333pt;'>域名</a>
<a href='http://www.521php.com/archives/tag/wailian/' class='tag-link-25' title='5 个话题' style='font-size: 14.133333333333pt;'>外链</a>
<a href='http://www.521php.com/archives/tag/touxiang/' class='tag-link-14' title='2 个话题' style='font-size: 12.8pt;'>头像</a>
<a href='http://www.521php.com/archives/tag/zifu/' class='tag-link-35' title='12 个话题' style='font-size: 15.6pt;'>字符</a>
<a href='http://www.521php.com/archives/tag/aq/' class='tag-link-72' title='6 个话题' style='font-size: 14.444444444444pt;'>安全</a>
<a href='http://www.521php.com/archives/tag/daohang/' class='tag-link-17' title='2 个话题' style='font-size: 12.8pt;'>导航</a>
<a href='http://www.521php.com/archives/tag/phome/' class='tag-link-67' title='6 个话题' style='font-size: 14.444444444444pt;'>帝国cms</a>
<a href='http://www.521php.com/archives/tag/zongjie/' class='tag-link-40' title='85 个话题' style='font-size: 19.244444444444pt;'>总结</a>
<a href='http://www.521php.com/archives/tag/jiekou/' class='tag-link-31' title='15 个话题' style='font-size: 16pt;'>接口</a>
<a href='http://www.521php.com/archives/tag/shuju/' class='tag-link-54' title='27 个话题' style='font-size: 17.111111111111pt;'>数据处理</a>
<a href='http://www.521php.com/archives/tag/array/' class='tag-link-38' title='2 个话题' style='font-size: 12.8pt;'>数组</a>
<a href='http://www.521php.com/archives/tag/wenjian/' class='tag-link-36' title='18 个话题' style='font-size: 16.355555555556pt;'>文件</a>
<a href='http://www.521php.com/archives/tag/%e6%97%a5%e5%bf%97/' class='tag-link-9' title='21 个话题' style='font-size: 16.622222222222pt;'>日志</a>
<a href='http://www.521php.com/archives/tag/sever/' class='tag-link-62' title='2 个话题' style='font-size: 12.8pt;'>服务器</a>
<a href='http://www.521php.com/archives/tag/zatan/' class='tag-link-47' title='33 个话题' style='font-size: 17.466666666667pt;'>杂谈</a>
<a href='http://www.521php.com/archives/tag/muban/' class='tag-link-29' title='4 个话题' style='font-size: 13.777777777778pt;'>模板</a>
<a href='http://www.521php.com/archives/tag/preg/' class='tag-link-39' title='3 个话题' style='font-size: 13.333333333333pt;'>正则</a>
<a href='http://www.521php.com/archives/tag/liulan/' class='tag-link-22' title='2 个话题' style='font-size: 12.8pt;'>浏览</a>
<a href='http://www.521php.com/archives/tag/game/' class='tag-link-68' title='1 个话题' style='font-size: 12pt;'>游戏</a>
<a href='http://www.521php.com/archives/tag/dianji/' class='tag-link-21' title='3 个话题' style='font-size: 13.333333333333pt;'>点击</a>
<a href='http://www.521php.com/archives/tag/liuyan/' class='tag-link-13' title='2 个话题' style='font-size: 12.8pt;'>留言</a>
<a href='http://www.521php.com/archives/tag/kongjian/' class='tag-link-19' title='1 个话题' style='font-size: 12pt;'>空间</a>
<a href='http://www.521php.com/archives/tag/class/' class='tag-link-49' title='8 个话题' style='font-size: 14.888888888889pt;'>类</a>
<a href='http://www.521php.com/archives/tag/zhimeng/' class='tag-link-30' title='13 个话题' style='font-size: 15.777777777778pt;'>织梦</a>
<a href='http://www.521php.com/archives/tag/tongji/' class='tag-link-37' title='2 个话题' style='font-size: 12.8pt;'>统计</a>
<a href='http://www.521php.com/archives/tag/hyzx/' class='tag-link-60' title='9 个话题' style='font-size: 15.111111111111pt;'>行业资讯</a>
<a href='http://www.521php.com/archives/tag/zhuanzhai/' class='tag-link-58' title='41 个话题' style='font-size: 17.866666666667pt;'>转载</a>
<a href='http://www.521php.com/archives/tag/process/' class='tag-link-78' title='1 个话题' style='font-size: 12pt;'>进程</a>
<a href='http://www.521php.com/archives/tag/email/' class='tag-link-42' title='1 个话题' style='font-size: 12pt;'>邮件</a>
<a href='http://www.521php.com/archives/tag/xianzhibiti/' class='tag-link-23' title='4 个话题' style='font-size: 13.777777777778pt;'>限制标题长度</a>
<a href='http://www.521php.com/archives/tag/oo/' class='tag-link-48' title='2 个话题' style='font-size: 12.8pt;'>面向对象</a>					                    </div>
                </div>
                <div class="sidebar_b_bot"><!--样式尾部--></div>
            </div>
				
            <!--最新留言-->
            <div class="sidebar_body">
           	  <div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg">
                            <H3><a href="/message/" title="留言板">最新留言</a></H3>
                        </div>
                    </div>
                    <div class="sid_body">
                    	<ul class="sid_recent">

<li><img src='http://www.521php.com/avatar/73131a70bed0ca2cc0d5e5c6d656d274.jpg'/><span class='rc_info'><span class='rc_name'>dolove</span> 评论道：<br /><a href="http://www.521php.com/archives/1039/#comment-8649" title="查看 自己改版的非常好用的php分页类，可支持伪静态">数据库代码引用方法没写。。</a></li><div class=clear></div>
<li><img src='http://www.521php.com/avatar/7b3973ade41a195cfaf37ba35072cc3e.jpg'/><span class='rc_info'><span class='rc_name'>爱转角</span> 评论道：<br /><a href="http://www.521php.com/message/#comment-8647" title="查看 关于我">俺也在学php不过是菜鸟</a></li><div class=clear></div>
<li><img src='http://www.521php.com/avatar/cf0d506c6516d2394cd9af4d8a6b510f.jpg'/><span class='rc_info'><span class='rc_name'>maillot saxo bank</span> 评论道：<br /><a href="http://www.521php.com/archives/1756/#comment-8644" title="查看 4年了，给您汇报一下">出门在外 不容易阿。</a></li><div class=clear></div>
<li><img src='http://www.521php.com/avatar/fbe577075491a475a6592530dd696e7c.jpg'/><span class='rc_info'><span class='rc_name'>XpertSU</span> 评论道：<br /><a href="http://www.521php.com/archives/879/#comment-8638" title="查看 菜鸟程序员的提升之道">本人刚毕业工作了三个月的菜鸟，</a></li><div class=clear></div>
<li><img src='http://www.521php.com/avatar/2cd7a96d42ccceacd8386398a2ac2df6.jpg'/><span class='rc_info'><span class='rc_name'>boke123</span> 评论道：<br /><a href="http://www.521php.com/archives/1756/#comment-8632" title="查看 4年了，给您汇报一下">我跟博主有一点不一样的地方，就</a></li><div class=clear></div>
<li><img src='http://www.521php.com/avatar/35ee04912a474d57f344b3f19247ed48.jpg'/><span class='rc_info'><span class='rc_name'>易搜学</span> 评论道：<br /><a href="http://www.521php.com/message/#comment-8622" title="查看 关于我">看来博主是个php高手，真心佩</a></li><div class=clear></div>
<li><img src='http://www.521php.com/avatar/60521fdeccab00d819f6bf8cc42f5aa6.jpg'/><span class='rc_info'><span class='rc_name'>苏苏网赚博客</span> 评论道：<br /><a href="http://www.521php.com/message/#comment-8606" title="查看 关于我">本站地址http://5913</a></li><div class=clear></div>
<li><img src='http://www.521php.com/avatar/8331012aa924b50c2011d068432a4c15.jpg'/><span class='rc_info'><span class='rc_name'>金属打包机</span> 评论道：<br /><a href="http://www.521php.com/archives/1728/#comment-8582" title="查看 转-技术人员如何参与产品设计讨论：激活那一潭死水">网站做的不错，是wp的高手。你</a></li><div class=clear></div> 
                        </ul>
                    </div>
                </div>
                <div class="sidebar_b_bot"><!--样式尾部--></div>
            </div>
	        <!--小工具-->
            		<div id="archives-2" class="sidebar_body"><div class="sidebar_b_top"><!--样式头部--></div>
                <div class="sidebar_b_main">
                	<div class="sid_ify">
                    	<div class="sid_ify_bg"><h3 class="widget-title">文章归档</h3></div></div>
<div class="sid_body">
		<ul class="sid_link_text">
			<li><a href='http://www.521php.com/archives/date/2014/07/' title='2014 年七月'>2014 年七月</a></li>
	<li><a href='http://www.521php.com/archives/date/2014/06/' title='2014 年六月'>2014 年六月</a></li>
	<li><a href='http://www.521php.com/archives/date/2014/05/' title='2014 年五月'>2014 年五月</a></li>
	<li><a href='http://www.521php.com/archives/date/2014/04/' title='2014 年四月'>2014 年四月</a></li>
	<li><a href='http://www.521php.com/archives/date/2014/03/' title='2014 年三月'>2014 年三月</a></li>
	<li><a href='http://www.521php.com/archives/date/2014/01/' title='2014 年一月'>2014 年一月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/12/' title='2013 年十二月'>2013 年十二月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/11/' title='2013 年十一月'>2013 年十一月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/10/' title='2013 年十月'>2013 年十月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/08/' title='2013 年八月'>2013 年八月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/07/' title='2013 年七月'>2013 年七月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/06/' title='2013 年六月'>2013 年六月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/05/' title='2013 年五月'>2013 年五月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/04/' title='2013 年四月'>2013 年四月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/03/' title='2013 年三月'>2013 年三月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/02/' title='2013 年二月'>2013 年二月</a></li>
	<li><a href='http://www.521php.com/archives/date/2013/01/' title='2013 年一月'>2013 年一月</a></li>
	<li><a href='http://www.521php.com/archives/date/2012/12/' title='2012 年十二月'>2012 年十二月</a></li>
	<li><a href='http://www.521php.com/archives/date/2012/11/' title='2012 年十一月'>2012 年十一月</a></li>
	<li><a href='http://www.521php.com/archives/date/2012/10/' title='2012 年十月'>2012 年十月</a></li>
	<li><a href='http://www.521php.com/archives/date/2012/09/' title='2012 年九月'>2012 年九月</a></li>
	<li><a href='http://www.521php.com/archives/date/2012/08/' title='2012 年八月'>2012 年八月</a></li>
	<li><a href='http://www.521php.com/archives/date/2012/07/' title='2012 年七月'>2012 年七月</a></li>
	<li><a href='http://www.521php.com/archives/date/2012/06/' title='2012 年六月'>2012 年六月</a></li>
		</ul>
		</div>
<div class="sidebar_b_bot"><!--样式尾部--></div></div>		<!-- #secondary .widget-area -->
                </div>        <div class="clear"></div>
    </div>
<!--中间内容End-->
</div>
<!--尾部-->
    <div id="footer">

    	<div id="footerbar">

        <p><span>Copy right © 2012<strong><a href="http://www.521php.com">张存超php个人博客</a></strong> 京ICP备14032588号-1</span></p>

        <p><span>Powered by WordPres | <a href="http://www.521php.com/sitemap.html" target="_blank">百度地图</a> | <a href="http://www.521php.com/sitemap_baidu.xml" target="_blank">谷歌地图</a></span></p>
		<p> <script src="http://s96.cnzz.com/stat.php?id=4200165&web_id=4200165" language="JavaScript"></script></p>
        </div>
    </div>

<!--尾部End-->
<script type="text/javascript" src="http://www.521php.com/api/tz/"></script>
<script type="text/javascript">
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?"":e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)d[e(c)]=k[c]||e(c);k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1;};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p;}('2(3!=0){0.1=5.1.4}',6,6,'top|location|if|self|href|this'.split('|'),0,{}))
</script>
<script type='text/javascript' src="http://www.521php.com/wailian/public/scripts/tj.js"></script>
<SCRIPT src="http://www.521php.com/wp-content/themes/zeke/MRjs/jquery.min.js" type="text/javascript"></SCRIPT>
<script type="text/javascript" language="javascript" src="http://www.521php.com/wp-content/themes/zeke/MRjs/jquery.lazyload.js"></script>
<SCRIPT src="http://www.521php.com/wp-content/themes/zeke/MRjs/custom.js" type="text/javascript"></SCRIPT>
<SCRIPT src="http://www.521php.com/wp-content/themes/zeke/miaov.js" type="text/javascript"></SCRIPT>
<!-- JiaThis Button BEGIN -->
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_r.js?uid=1347699766672865&move=0&amp;btn=r1.gif" charset="utf-8"></script>
<!-- JiaThis Button END -->
<!-- UJian Button BEGIN -->
<script type="text/javascript" src="http://v1.ujian.cc/code/ujian.js?type=slide&uid=1699342"></script>
<!-- UJian Button END -->
</body>

</html>
<!-- Dynamic page generated in 4.727 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2014-07-26 06:56:03 -->

<!-- super cache -->